import{S as me,v as S,e as De,Y as _,C as we,P as Ae,m as c,E as p,Z as y,D as be,I as ye,a as ze,b,H as E,X as j,j as Xe,B as xe,Q as O,U as Ue,c as $,T as Ze,d as He}from"./graph-e9862b7e-DxmcR3sM.js";import{p as ke,ab as B,a2 as Ee,a9 as Qe,ac as We,ad as Je,B as Q,l as Ne,w as W,a6 as Ke,ae as Z,af as er,C as F,u as rr,X as _e,a5 as nr}from"./mermaid.esm.min-B1dwJ9Lo.js";var tr=/\s/;function or(e){for(var r=e.length;r--&&tr.test(e.charAt(r)););return r}var ir=/^\s+/;function ur(e){return e&&e.slice(0,or(e)+1).replace(ir,"")}var ue=NaN,ar=/^[-+]0x[0-9a-f]+$/i,dr=/^0b[01]+$/i,fr=/^0o[0-7]+$/i,cr=parseInt;function sr(e){if(typeof e=="number")return e;if(O(e))return ue;if(F(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=F(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=ur(e);var n=dr.test(e);return n||fr.test(e)?cr(e.slice(2),n?2:8):ar.test(e)?ue:+e}var gr=1/0,vr=17976931348623157e292;function P(e){if(!e)return e===0?e:0;if(e=sr(e),e===gr||e===-1/0){var r=e<0?-1:1;return r*vr}return e===e?e:0}function hr(e){var r=P(e),n=r%1;return r===r?n?r-n:r:0}function I(e){var r=e==null?0:e.length;return r?me(e):[]}function lr(e){return We(Je(e,void 0,I),e+"")}var pr=1,mr=4;function wr(e){return Xe(e,pr|mr)}var Ie=Object.prototype,br=Ie.hasOwnProperty,yr=ke(function(e,r){e=Object(e);var n=-1,t=r.length,o=t>2?r[2]:void 0;for(o&&B(r[0],r[1],o)&&(t=1);++n<t;)for(var u=r[n],i=Ee(u),a=-1,d=i.length;++a<d;){var f=i[a],s=e[f];(s===void 0||Qe(s,Ie[f])&&!br.call(e,f))&&(e[f]=u[f])}return e});const xr=yr;function Y(e){var r=e==null?0:e.length;return r?e[r-1]:void 0}function kr(e){return function(r,n,t){var o=Object(r);if(!Ne(r)){var u=_(n);r=Ze(r),n=function(a){return u(o[a],a,o)}}var i=e(r,n,t);return i>-1?o[u?r[i]:i]:void 0}}var Er=Math.max;function Nr(e,r,n){var t=e==null?0:e.length;if(!t)return-1;var o=n==null?0:hr(n);return o<0&&(o=Er(t+o,0)),He(e,_(r),o)}var _r=kr(Nr);const J=_r;function Re(e,r){var n=-1,t=Ne(e)?Array(e.length):[];return De(e,function(o,u,i){t[++n]=r(o,u,i)}),t}function m(e,r){var n=W(e)?S:Re;return n(e,_(r))}function Ir(e,r){return e==null?e:nr(e,xe(r),Ee)}function Rr(e,r){return be(e,xe(r))}function Tr(e,r){return e>r}function Te(e,r){return e<r}function V(e,r){var n={};return r=_(r),be(e,function(t,o,u){er(n,o,r(t,o,u))}),n}function K(e,r,n){for(var t=-1,o=e.length;++t<o;){var u=e[t],i=r(u);if(i!=null&&(a===void 0?i===i&&!O(i):n(i,a)))var a=i,d=u}return d}function x(e){return e&&e.length?K(e,Q,Tr):void 0}function M(e){return e&&e.length?K(e,Q,Te):void 0}function ee(e,r){return e&&e.length?K(e,_(r),Te):void 0}function Mr(e,r,n,t){if(!F(e))return e;r=ye(r,e);for(var o=-1,u=r.length,i=u-1,a=e;a!=null&&++o<u;){var d=Ue(r[o]),f=n;if(d==="__proto__"||d==="constructor"||d==="prototype")return e;if(o!=i){var s=a[d];f=void 0,f===void 0&&(f=F(s)?s:rr(r[o+1])?[]:{})}_e(a,d,f),a=a[d]}return e}function Cr(e,r,n){for(var t=-1,o=r.length,u={};++t<o;){var i=r[t],a=we(e,i);n(a,i)&&Mr(u,ye(i,e),a)}return u}function $r(e,r){var n=e.length;for(e.sort(r);n--;)e[n]=e[n].value;return e}function Lr(e,r){if(e!==r){var n=e!==void 0,t=e===null,o=e===e,u=O(e),i=r!==void 0,a=r===null,d=r===r,f=O(r);if(!a&&!f&&!u&&e>r||u&&i&&d&&!a&&!f||t&&i&&d||!n&&d||!o)return 1;if(!t&&!u&&!f&&e<r||f&&n&&o&&!t&&!u||a&&n&&o||!i&&o||!d)return-1}return 0}function Sr(e,r,n){for(var t=-1,o=e.criteria,u=r.criteria,i=o.length,a=n.length;++t<i;){var d=Lr(o[t],u[t]);if(d){if(t>=a)return d;var f=n[t];return d*(f=="desc"?-1:1)}}return e.index-r.index}function Pr(e,r,n){r.length?r=S(r,function(u){return W(u)?function(i){return we(i,u.length===1?u[0]:u)}:u}):r=[Q];var t=-1;r=S(r,Ke(_));var o=Re(e,function(u,i,a){var d=S(r,function(f){return f(u)});return{criteria:d,index:++t,value:u}});return $r(o,function(u,i){return Sr(u,i,n)})}function Or(e,r){return Cr(e,r,function(n,t){return ze(e,t)})}var Br=lr(function(e,r){return e==null?{}:Or(e,r)});const G=Br;var Fr=Math.ceil,Yr=Math.max;function Gr(e,r,n,t){for(var o=-1,u=Yr(Fr((r-e)/(n||1)),0),i=Array(u);u--;)i[++o]=e,e+=n;return i}function jr(e){return function(r,n,t){return t&&typeof t!="number"&&B(r,n,t)&&(n=t=void 0),r=P(r),n===void 0?(n=r,r=0):n=P(n),t=t===void 0?r<n?1:-1:P(t),Gr(r,n,t)}}var Vr=jr();const N=Vr;var qr=ke(function(e,r){if(e==null)return[];var n=r.length;return n>1&&B(e,r[0],r[1])?r=[]:n>2&&B(r[0],r[1],r[2])&&(r=[r[0]]),Pr(e,me(r),[])});const L=qr;var Dr=0;function re(e){var r=++Dr;return Ae(e)+r}function Ar(e,r,n){for(var t=-1,o=e.length,u=r.length,i={};++t<o;){var a=t<u?r[t]:void 0;n(i,e[t],a)}return i}function zr(e,r){return Ar(e||[],r||[],_e)}class Xr{constructor(){var r={};r._next=r._prev=r,this._sentinel=r}dequeue(){var r=this._sentinel,n=r._prev;if(n!==r)return ae(n),n}enqueue(r){var n=this._sentinel;r._prev&&r._next&&ae(r),r._next=n._next,n._next._prev=r,n._next=r,r._prev=n}toString(){for(var r=[],n=this._sentinel,t=n._prev;t!==n;)r.push(JSON.stringify(t,Ur)),t=t._prev;return"["+r.join(", ")+"]"}}function ae(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Ur(e,r){if(e!=="_next"&&e!=="_prev")return r}function Zr(e,r){if(e.nodeCount()<=1)return[];var n=Qr(e,r),t=Hr(n.graph,n.buckets,n.zeroIdx);return I(m(t,function(o){return e.outEdges(o.v,o.w)}))}function Hr(e,r,n){for(var t=[],o=r[r.length-1],u=r[0],i;e.nodeCount();){for(;i=u.dequeue();)D(e,r,n,i);for(;i=o.dequeue();)D(e,r,n,i);if(e.nodeCount()){for(var a=r.length-2;a>0;--a)if(i=r[a].dequeue(),i){t=t.concat(D(e,r,n,i,!0));break}}}return t}function D(e,r,n,t,o){var u=o?[]:void 0;return c(e.inEdges(t.v),function(i){var a=e.edge(i),d=e.node(i.v);o&&u.push({v:i.v,w:i.w}),d.out-=a,H(r,n,d)}),c(e.outEdges(t.v),function(i){var a=e.edge(i),d=i.w,f=e.node(d);f.in-=a,H(r,n,f)}),e.removeNode(t.v),u}function Qr(e,r){var n=new y,t=0,o=0;c(e.nodes(),function(a){n.setNode(a,{v:a,in:0,out:0})}),c(e.edges(),function(a){var d=n.edge(a.v,a.w)||0,f=r(a),s=d+f;n.setEdge(a.v,a.w,s),o=Math.max(o,n.node(a.v).out+=f),t=Math.max(t,n.node(a.w).in+=f)});var u=N(o+t+3).map(function(){return new Xr}),i=t+1;return c(n.nodes(),function(a){H(u,i,n.node(a))}),{graph:n,buckets:u,zeroIdx:i}}function H(e,r,n){n.out?n.in?e[n.out-n.in+r].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function Wr(e){var r=e.graph().acyclicer==="greedy"?Zr(e,n(e)):Jr(e);c(r,function(t){var o=e.edge(t);e.removeEdge(t),o.forwardName=t.name,o.reversed=!0,e.setEdge(t.w,t.v,o,re("rev"))});function n(t){return function(o){return t.edge(o).weight}}}function Jr(e){var r=[],n={},t={};function o(u){p(t,u)||(t[u]=!0,n[u]=!0,c(e.outEdges(u),function(i){p(n,i.w)?r.push(i):o(i.w)}),delete n[u])}return c(e.nodes(),o),r}function Kr(e){c(e.edges(),function(r){var n=e.edge(r);if(n.reversed){e.removeEdge(r);var t=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(r.w,r.v,n,t)}})}function R(e,r,n,t){var o;do o=re(t);while(e.hasNode(o));return n.dummy=r,e.setNode(o,n),o}function en(e){var r=new y().setGraph(e.graph());return c(e.nodes(),function(n){r.setNode(n,e.node(n))}),c(e.edges(),function(n){var t=r.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);r.setEdge(n.v,n.w,{weight:t.weight+o.weight,minlen:Math.max(t.minlen,o.minlen)})}),r}function Me(e){var r=new y({multigraph:e.isMultigraph()}).setGraph(e.graph());return c(e.nodes(),function(n){e.children(n).length||r.setNode(n,e.node(n))}),c(e.edges(),function(n){r.setEdge(n,e.edge(n))}),r}function de(e,r){var n=e.x,t=e.y,o=r.x-n,u=r.y-t,i=e.width/2,a=e.height/2;if(!o&&!u)throw new Error("Not possible to find intersection inside of the rectangle");var d,f;return Math.abs(u)*i>Math.abs(o)*a?(u<0&&(a=-a),d=a*o/u,f=a):(o<0&&(i=-i),d=i,f=i*u/o),{x:n+d,y:t+f}}function q(e){var r=m(N(Ce(e)+1),function(){return[]});return c(e.nodes(),function(n){var t=e.node(n),o=t.rank;b(o)||(r[o][t.order]=n)}),r}function rn(e){var r=M(m(e.nodes(),function(n){return e.node(n).rank}));c(e.nodes(),function(n){var t=e.node(n);p(t,"rank")&&(t.rank-=r)})}function nn(e){var r=M(m(e.nodes(),function(u){return e.node(u).rank})),n=[];c(e.nodes(),function(u){var i=e.node(u).rank-r;n[i]||(n[i]=[]),n[i].push(u)});var t=0,o=e.graph().nodeRankFactor;c(n,function(u,i){b(u)&&i%o!==0?--t:t&&c(u,function(a){e.node(a).rank+=t})})}function fe(e,r,n,t){var o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=t),R(e,"border",o,r)}function Ce(e){return x(m(e.nodes(),function(r){var n=e.node(r).rank;if(!b(n))return n}))}function tn(e,r){var n={lhs:[],rhs:[]};return c(e,function(t){r(t)?n.lhs.push(t):n.rhs.push(t)}),n}function on(e,r){return r()}function un(e){function r(n){var t=e.children(n),o=e.node(n);if(t.length&&c(t,r),p(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var u=o.minRank,i=o.maxRank+1;u<i;++u)ce(e,"borderLeft","_bl",n,o,u),ce(e,"borderRight","_br",n,o,u)}}c(e.children(),r)}function ce(e,r,n,t,o,u){var i={width:0,height:0,rank:u,borderType:r},a=o[r][u-1],d=R(e,"border",i,n);o[r][u]=d,e.setParent(d,t),a&&e.setEdge(a,d,{weight:1})}function an(e){var r=e.graph().rankdir.toLowerCase();(r==="lr"||r==="rl")&&$e(e)}function dn(e){var r=e.graph().rankdir.toLowerCase();(r==="bt"||r==="rl")&&fn(e),(r==="lr"||r==="rl")&&(cn(e),$e(e))}function $e(e){c(e.nodes(),function(r){se(e.node(r))}),c(e.edges(),function(r){se(e.edge(r))})}function se(e){var r=e.width;e.width=e.height,e.height=r}function fn(e){c(e.nodes(),function(r){A(e.node(r))}),c(e.edges(),function(r){var n=e.edge(r);c(n.points,A),p(n,"y")&&A(n)})}function A(e){e.y=-e.y}function cn(e){c(e.nodes(),function(r){z(e.node(r))}),c(e.edges(),function(r){var n=e.edge(r);c(n.points,z),p(n,"x")&&z(n)})}function z(e){var r=e.x;e.x=e.y,e.y=r}function sn(e){e.graph().dummyChains=[],c(e.edges(),function(r){gn(e,r)})}function gn(e,r){var n=r.v,t=e.node(n).rank,o=r.w,u=e.node(o).rank,i=r.name,a=e.edge(r),d=a.labelRank;if(u!==t+1){e.removeEdge(r);var f,s,g;for(g=0,++t;t<u;++g,++t)a.points=[],s={width:0,height:0,edgeLabel:a,edgeObj:r,rank:t},f=R(e,"edge",s,"_d"),t===d&&(s.width=a.width,s.height=a.height,s.dummy="edge-label",s.labelpos=a.labelpos),e.setEdge(n,f,{weight:a.weight},i),g===0&&e.graph().dummyChains.push(f),n=f;e.setEdge(n,o,{weight:a.weight},i)}}function vn(e){c(e.graph().dummyChains,function(r){var n=e.node(r),t=n.edgeLabel,o;for(e.setEdge(n.edgeObj,t);n.dummy;)o=e.successors(r)[0],e.removeNode(r),t.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height),r=o,n=e.node(r)})}function ne(e){var r={};function n(t){var o=e.node(t);if(p(r,t))return o.rank;r[t]=!0;var u=M(m(e.outEdges(t),function(i){return n(i.w)-e.edge(i).minlen}));return(u===Number.POSITIVE_INFINITY||u===void 0||u===null)&&(u=0),o.rank=u}c(e.sources(),n)}function C(e,r){return e.node(r.w).rank-e.node(r.v).rank-e.edge(r).minlen}function Le(e){var r=new y({directed:!1}),n=e.nodes()[0],t=e.nodeCount();r.setNode(n,{});for(var o,u;hn(r,e)<t;)o=ln(r,e),u=r.hasNode(o.v)?C(e,o):-C(e,o),pn(r,e,u);return r}function hn(e,r){function n(t){c(r.nodeEdges(t),function(o){var u=o.v,i=t===u?o.w:u;!e.hasNode(i)&&!C(r,o)&&(e.setNode(i,{}),e.setEdge(t,i,{}),n(i))})}return c(e.nodes(),n),e.nodeCount()}function ln(e,r){return ee(r.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return C(r,n)})}function pn(e,r,n){c(e.nodes(),function(t){r.node(t).rank+=n})}function Se(e,r,n){W(r)||(r=[r]);var t=(e.isDirected()?e.successors:e.neighbors).bind(e),o=[],u={};return c(r,function(i){if(!e.hasNode(i))throw new Error("Graph does not have node: "+i);Pe(e,i,n==="post",u,t,o)}),o}function Pe(e,r,n,t,o,u){p(t,r)||(t[r]=!0,n||u.push(r),c(o(r),function(i){Pe(e,i,n,t,o,u)}),n&&u.push(r))}function mn(e,r){return Se(e,r,"post")}function wn(e,r){return Se(e,r,"pre")}k.initLowLimValues=oe;k.initCutValues=te;k.calcCutValue=Oe;k.leaveEdge=Fe;k.enterEdge=Ye;k.exchangeEdges=Ge;function k(e){e=en(e),ne(e);var r=Le(e);oe(r),te(r,e);for(var n,t;n=Fe(r);)t=Ye(r,e,n),Ge(r,e,n,t)}function te(e,r){var n=mn(e,e.nodes());n=n.slice(0,n.length-1),c(n,function(t){bn(e,r,t)})}function bn(e,r,n){var t=e.node(n),o=t.parent;e.edge(n,o).cutvalue=Oe(e,r,n)}function Oe(e,r,n){var t=e.node(n),o=t.parent,u=!0,i=r.edge(n,o),a=0;return i||(u=!1,i=r.edge(o,n)),a=i.weight,c(r.nodeEdges(n),function(d){var f=d.v===n,s=f?d.w:d.v;if(s!==o){var g=f===u,v=r.edge(d).weight;if(a+=g?v:-v,xn(e,n,s)){var h=e.edge(n,s).cutvalue;a+=g?-h:h}}}),a}function oe(e,r){arguments.length<2&&(r=e.nodes()[0]),Be(e,{},1,r)}function Be(e,r,n,t,o){var u=n,i=e.node(t);return r[t]=!0,c(e.neighbors(t),function(a){p(r,a)||(n=Be(e,r,n,a,t))}),i.low=u,i.lim=n++,o?i.parent=o:delete i.parent,n}function Fe(e){return J(e.edges(),function(r){return e.edge(r).cutvalue<0})}function Ye(e,r,n){var t=n.v,o=n.w;r.hasEdge(t,o)||(t=n.w,o=n.v);var u=e.node(t),i=e.node(o),a=u,d=!1;u.lim>i.lim&&(a=i,d=!0);var f=$(r.edges(),function(s){return d===ge(e,e.node(s.v),a)&&d!==ge(e,e.node(s.w),a)});return ee(f,function(s){return C(r,s)})}function Ge(e,r,n,t){var o=n.v,u=n.w;e.removeEdge(o,u),e.setEdge(t.v,t.w,{}),oe(e),te(e,r),yn(e,r)}function yn(e,r){var n=J(e.nodes(),function(o){return!r.node(o).parent}),t=wn(e,n);t=t.slice(1),c(t,function(o){var u=e.node(o).parent,i=r.edge(o,u),a=!1;i||(i=r.edge(u,o),a=!0),r.node(o).rank=r.node(u).rank+(a?i.minlen:-i.minlen)})}function xn(e,r,n){return e.hasEdge(r,n)}function ge(e,r,n){return n.low<=r.lim&&r.lim<=n.lim}function kn(e){switch(e.graph().ranker){case"network-simplex":ve(e);break;case"tight-tree":Nn(e);break;case"longest-path":En(e);break;default:ve(e)}}var En=ne;function Nn(e){ne(e),Le(e)}function ve(e){k(e)}function _n(e){var r=R(e,"root",{},"_root"),n=In(e),t=x(E(n))-1,o=2*t+1;e.graph().nestingRoot=r,c(e.edges(),function(i){e.edge(i).minlen*=o});var u=Rn(e)+1;c(e.children(),function(i){je(e,r,o,u,t,n,i)}),e.graph().nodeRankFactor=o}function je(e,r,n,t,o,u,i){var a=e.children(i);if(!a.length){i!==r&&e.setEdge(r,i,{weight:0,minlen:n});return}var d=fe(e,"_bt"),f=fe(e,"_bb"),s=e.node(i);e.setParent(d,i),s.borderTop=d,e.setParent(f,i),s.borderBottom=f,c(a,function(g){je(e,r,n,t,o,u,g);var v=e.node(g),h=v.borderTop?v.borderTop:g,l=v.borderBottom?v.borderBottom:g,w=v.borderTop?t:2*t,T=h!==l?1:o-u[i]+1;e.setEdge(d,h,{weight:w,minlen:T,nestingEdge:!0}),e.setEdge(l,f,{weight:w,minlen:T,nestingEdge:!0})}),e.parent(i)||e.setEdge(r,d,{weight:0,minlen:o+u[i]})}function In(e){var r={};function n(t,o){var u=e.children(t);u&&u.length&&c(u,function(i){n(i,o+1)}),r[t]=o}return c(e.children(),function(t){n(t,1)}),r}function Rn(e){return j(e.edges(),function(r,n){return r+e.edge(n).weight},0)}function Tn(e){var r=e.graph();e.removeNode(r.nestingRoot),delete r.nestingRoot,c(e.edges(),function(n){var t=e.edge(n);t.nestingEdge&&e.removeEdge(n)})}function Mn(e,r,n){var t={},o;c(n,function(u){for(var i=e.parent(u),a,d;i;){if(a=e.parent(i),a?(d=t[a],t[a]=i):(d=o,o=i),d&&d!==i){r.setEdge(d,i);return}i=a}})}function Cn(e,r,n){var t=$n(e),o=new y({compound:!0}).setGraph({root:t}).setDefaultNodeLabel(function(u){return e.node(u)});return c(e.nodes(),function(u){var i=e.node(u),a=e.parent(u);(i.rank===r||i.minRank<=r&&r<=i.maxRank)&&(o.setNode(u),o.setParent(u,a||t),c(e[n](u),function(d){var f=d.v===u?d.w:d.v,s=o.edge(f,u),g=b(s)?0:s.weight;o.setEdge(f,u,{weight:e.edge(d).weight+g})}),p(i,"minRank")&&o.setNode(u,{borderLeft:i.borderLeft[r],borderRight:i.borderRight[r]}))}),o}function $n(e){for(var r;e.hasNode(r=re("_root")););return r}function Ln(e,r){for(var n=0,t=1;t<r.length;++t)n+=Sn(e,r[t-1],r[t]);return n}function Sn(e,r,n){for(var t=zr(n,m(n,function(f,s){return s})),o=I(m(r,function(f){return L(m(e.outEdges(f),function(s){return{pos:t[s.w],weight:e.edge(s).weight}}),"pos")})),u=1;u<n.length;)u<<=1;var i=2*u-1;u-=1;var a=m(new Array(i),function(){return 0}),d=0;return c(o.forEach(function(f){var s=f.pos+u;a[s]+=f.weight;for(var g=0;s>0;)s%2&&(g+=a[s+1]),s=s-1>>1,a[s]+=f.weight;d+=f.weight*g})),d}function Pn(e){var r={},n=$(e.nodes(),function(a){return!e.children(a).length}),t=x(m(n,function(a){return e.node(a).rank})),o=m(N(t+1),function(){return[]});function u(a){if(!p(r,a)){r[a]=!0;var d=e.node(a);o[d.rank].push(a),c(e.successors(a),u)}}var i=L(n,function(a){return e.node(a).rank});return c(i,u),o}function On(e,r){return m(r,function(n){var t=e.inEdges(n);if(t.length){var o=j(t,function(u,i){var a=e.edge(i),d=e.node(i.v);return{sum:u.sum+a.weight*d.order,weight:u.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:o.sum/o.weight,weight:o.weight}}else return{v:n}})}function Bn(e,r){var n={};c(e,function(o,u){var i=n[o.v]={indegree:0,in:[],out:[],vs:[o.v],i:u};b(o.barycenter)||(i.barycenter=o.barycenter,i.weight=o.weight)}),c(r.edges(),function(o){var u=n[o.v],i=n[o.w];!b(u)&&!b(i)&&(i.indegree++,u.out.push(n[o.w]))});var t=$(n,function(o){return!o.indegree});return Fn(t)}function Fn(e){var r=[];function n(u){return function(i){i.merged||(b(i.barycenter)||b(u.barycenter)||i.barycenter>=u.barycenter)&&Yn(u,i)}}function t(u){return function(i){i.in.push(u),--i.indegree===0&&e.push(i)}}for(;e.length;){var o=e.pop();r.push(o),c(o.in.reverse(),n(o)),c(o.out,t(o))}return m($(r,function(u){return!u.merged}),function(u){return G(u,["vs","i","barycenter","weight"])})}function Yn(e,r){var n=0,t=0;e.weight&&(n+=e.barycenter*e.weight,t+=e.weight),r.weight&&(n+=r.barycenter*r.weight,t+=r.weight),e.vs=r.vs.concat(e.vs),e.barycenter=n/t,e.weight=t,e.i=Math.min(r.i,e.i),r.merged=!0}function Gn(e,r){var n=tn(e,function(s){return p(s,"barycenter")}),t=n.lhs,o=L(n.rhs,function(s){return-s.i}),u=[],i=0,a=0,d=0;t.sort(jn(!!r)),d=he(u,o,d),c(t,function(s){d+=s.vs.length,u.push(s.vs),i+=s.barycenter*s.weight,a+=s.weight,d=he(u,o,d)});var f={vs:I(u)};return a&&(f.barycenter=i/a,f.weight=a),f}function he(e,r,n){for(var t;r.length&&(t=Y(r)).i<=n;)r.pop(),e.push(t.vs),n++;return n}function jn(e){return function(r,n){return r.barycenter<n.barycenter?-1:r.barycenter>n.barycenter?1:e?n.i-r.i:r.i-n.i}}function Ve(e,r,n,t){var o=e.children(r),u=e.node(r),i=u?u.borderLeft:void 0,a=u?u.borderRight:void 0,d={};i&&(o=$(o,function(l){return l!==i&&l!==a}));var f=On(e,o);c(f,function(l){if(e.children(l.v).length){var w=Ve(e,l.v,n,t);d[l.v]=w,p(w,"barycenter")&&qn(l,w)}});var s=Bn(f,n);Vn(s,d);var g=Gn(s,t);if(i&&(g.vs=I([i,g.vs,a]),e.predecessors(i).length)){var v=e.node(e.predecessors(i)[0]),h=e.node(e.predecessors(a)[0]);p(g,"barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+v.order+h.order)/(g.weight+2),g.weight+=2}return g}function Vn(e,r){c(e,function(n){n.vs=I(n.vs.map(function(t){return r[t]?r[t].vs:t}))})}function qn(e,r){b(e.barycenter)?(e.barycenter=r.barycenter,e.weight=r.weight):(e.barycenter=(e.barycenter*e.weight+r.barycenter*r.weight)/(e.weight+r.weight),e.weight+=r.weight)}function Dn(e){var r=Ce(e),n=le(e,N(1,r+1),"inEdges"),t=le(e,N(r-1,-1,-1),"outEdges"),o=Pn(e);pe(e,o);for(var u=Number.POSITIVE_INFINITY,i,a=0,d=0;d<4;++a,++d){An(a%2?n:t,a%4>=2),o=q(e);var f=Ln(e,o);f<u&&(d=0,i=wr(o),u=f)}pe(e,i)}function le(e,r,n){return m(r,function(t){return Cn(e,t,n)})}function An(e,r){var n=new y;c(e,function(t){var o=t.graph().root,u=Ve(t,o,n,r);c(u.vs,function(i,a){t.node(i).order=a}),Mn(t,n,u.vs)})}function pe(e,r){c(r,function(n){c(n,function(t,o){e.node(t).order=o})})}function zn(e){var r=Un(e);c(e.graph().dummyChains,function(n){for(var t=e.node(n),o=t.edgeObj,u=Xn(e,r,o.v,o.w),i=u.path,a=u.lca,d=0,f=i[d],s=!0;n!==o.w;){if(t=e.node(n),s){for(;(f=i[d])!==a&&e.node(f).maxRank<t.rank;)d++;f===a&&(s=!1)}if(!s){for(;d<i.length-1&&e.node(f=i[d+1]).minRank<=t.rank;)d++;f=i[d]}e.setParent(n,f),n=e.successors(n)[0]}})}function Xn(e,r,n,t){var o=[],u=[],i=Math.min(r[n].low,r[t].low),a=Math.max(r[n].lim,r[t].lim),d,f;d=n;do d=e.parent(d),o.push(d);while(d&&(r[d].low>i||a>r[d].lim));for(f=d,d=t;(d=e.parent(d))!==f;)u.push(d);return{path:o.concat(u.reverse()),lca:f}}function Un(e){var r={},n=0;function t(o){var u=n;c(e.children(o),t),r[o]={low:u,lim:n++}}return c(e.children(),t),r}function Zn(e,r){var n={};function t(o,u){var i=0,a=0,d=o.length,f=Y(u);return c(u,function(s,g){var v=Qn(e,s),h=v?e.node(v).order:d;(v||s===f)&&(c(u.slice(a,g+1),function(l){c(e.predecessors(l),function(w){var T=e.node(w),ie=T.order;(ie<i||h<ie)&&!(T.dummy&&e.node(l).dummy)&&qe(n,w,l)})}),a=g+1,i=h)}),u}return j(r,t),n}function Hn(e,r){var n={};function t(u,i,a,d,f){var s;c(N(i,a),function(g){s=u[g],e.node(s).dummy&&c(e.predecessors(s),function(v){var h=e.node(v);h.dummy&&(h.order<d||h.order>f)&&qe(n,v,s)})})}function o(u,i){var a=-1,d,f=0;return c(i,function(s,g){if(e.node(s).dummy==="border"){var v=e.predecessors(s);v.length&&(d=e.node(v[0]).order,t(i,f,g,a,d),f=g,a=d)}t(i,f,i.length,d,u.length)}),i}return j(r,o),n}function Qn(e,r){if(e.node(r).dummy)return J(e.predecessors(r),function(n){return e.node(n).dummy})}function qe(e,r,n){if(r>n){var t=r;r=n,n=t}var o=e[r];o||(e[r]=o={}),o[n]=!0}function Wn(e,r,n){if(r>n){var t=r;r=n,n=t}return p(e[r],n)}function Jn(e,r,n,t){var o={},u={},i={};return c(r,function(a){c(a,function(d,f){o[d]=d,u[d]=d,i[d]=f})}),c(r,function(a){var d=-1;c(a,function(f){var s=t(f);if(s.length){s=L(s,function(w){return i[w]});for(var g=(s.length-1)/2,v=Math.floor(g),h=Math.ceil(g);v<=h;++v){var l=s[v];u[f]===f&&d<i[l]&&!Wn(n,f,l)&&(u[l]=f,u[f]=o[f]=o[l],d=i[l])}}})}),{root:o,align:u}}function Kn(e,r,n,t,o){var u={},i=et(e,r,n,o),a=o?"borderLeft":"borderRight";function d(g,v){for(var h=i.nodes(),l=h.pop(),w={};l;)w[l]?g(l):(w[l]=!0,h.push(l),h=h.concat(v(l))),l=h.pop()}function f(g){u[g]=i.inEdges(g).reduce(function(v,h){return Math.max(v,u[h.v]+i.edge(h))},0)}function s(g){var v=i.outEdges(g).reduce(function(l,w){return Math.min(l,u[w.w]-i.edge(w))},Number.POSITIVE_INFINITY),h=e.node(g);v!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(u[g]=Math.max(u[g],v))}return d(f,i.predecessors.bind(i)),d(s,i.successors.bind(i)),c(t,function(g){u[g]=u[n[g]]}),u}function et(e,r,n,t){var o=new y,u=e.graph(),i=it(u.nodesep,u.edgesep,t);return c(r,function(a){var d;c(a,function(f){var s=n[f];if(o.setNode(s),d){var g=n[d],v=o.edge(g,s);o.setEdge(g,s,Math.max(i(e,f,d),v||0))}d=f})}),o}function rt(e,r){return ee(E(r),function(n){var t=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return Ir(n,function(u,i){var a=ut(e,i)/2;t=Math.max(u+a,t),o=Math.min(u-a,o)}),t-o})}function nt(e,r){var n=E(r),t=M(n),o=x(n);c(["u","d"],function(u){c(["l","r"],function(i){var a=u+i,d=e[a],f;if(d!==r){var s=E(d);f=i==="l"?t-M(s):o-x(s),f&&(e[a]=V(d,function(g){return g+f}))}})})}function tt(e,r){return V(e.ul,function(n,t){if(r)return e[r.toLowerCase()][t];var o=L(m(e,t));return(o[1]+o[2])/2})}function ot(e){var r=q(e),n=Z(Zn(e,r),Hn(e,r)),t={},o;c(["u","d"],function(i){o=i==="u"?r:E(r).reverse(),c(["l","r"],function(a){a==="r"&&(o=m(o,function(g){return E(g).reverse()}));var d=(i==="u"?e.predecessors:e.successors).bind(e),f=Jn(e,o,n,d),s=Kn(e,o,f.root,f.align,a==="r");a==="r"&&(s=V(s,function(g){return-g})),t[i+a]=s})});var u=rt(e,t);return nt(t,u),tt(t,e.graph().align)}function it(e,r,n){return function(t,o,u){var i=t.node(o),a=t.node(u),d=0,f;if(d+=i.width/2,p(i,"labelpos"))switch(i.labelpos.toLowerCase()){case"l":f=-i.width/2;break;case"r":f=i.width/2;break}if(f&&(d+=n?f:-f),f=0,d+=(i.dummy?r:e)/2,d+=(a.dummy?r:e)/2,d+=a.width/2,p(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":f=a.width/2;break;case"r":f=-a.width/2;break}return f&&(d+=n?f:-f),f=0,d}}function ut(e,r){return e.node(r).width}function at(e){e=Me(e),dt(e),Rr(ot(e),function(r,n){e.node(n).x=r})}function dt(e){var r=q(e),n=e.graph().ranksep,t=0;c(r,function(o){var u=x(m(o,function(i){return e.node(i).height}));c(o,function(i){e.node(i).y=t+u/2}),t+=u+n})}function Pt(e,r){var n=on;n("layout",function(){var t=n("  buildLayoutGraph",function(){return bt(e)});n("  runLayout",function(){ft(t,n)}),n("  updateInputGraph",function(){ct(e,t)})})}function ft(e,r){r("    makeSpaceForEdgeLabels",function(){yt(e)}),r("    removeSelfEdges",function(){Mt(e)}),r("    acyclic",function(){Wr(e)}),r("    nestingGraph.run",function(){_n(e)}),r("    rank",function(){kn(Me(e))}),r("    injectEdgeLabelProxies",function(){xt(e)}),r("    removeEmptyRanks",function(){nn(e)}),r("    nestingGraph.cleanup",function(){Tn(e)}),r("    normalizeRanks",function(){rn(e)}),r("    assignRankMinMax",function(){kt(e)}),r("    removeEdgeLabelProxies",function(){Et(e)}),r("    normalize.run",function(){sn(e)}),r("    parentDummyChains",function(){zn(e)}),r("    addBorderSegments",function(){un(e)}),r("    order",function(){Dn(e)}),r("    insertSelfEdges",function(){Ct(e)}),r("    adjustCoordinateSystem",function(){an(e)}),r("    position",function(){at(e)}),r("    positionSelfEdges",function(){$t(e)}),r("    removeBorderNodes",function(){Tt(e)}),r("    normalize.undo",function(){vn(e)}),r("    fixupEdgeLabelCoords",function(){It(e)}),r("    undoCoordinateSystem",function(){dn(e)}),r("    translateGraph",function(){Nt(e)}),r("    assignNodeIntersects",function(){_t(e)}),r("    reversePoints",function(){Rt(e)}),r("    acyclic.undo",function(){Kr(e)})}function ct(e,r){c(e.nodes(),function(n){var t=e.node(n),o=r.node(n);t&&(t.x=o.x,t.y=o.y,r.children(n).length&&(t.width=o.width,t.height=o.height))}),c(e.edges(),function(n){var t=e.edge(n),o=r.edge(n);t.points=o.points,p(o,"x")&&(t.x=o.x,t.y=o.y)}),e.graph().width=r.graph().width,e.graph().height=r.graph().height}var st=["nodesep","edgesep","ranksep","marginx","marginy"],gt={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},vt=["acyclicer","ranker","rankdir","align"],ht=["width","height"],lt={width:0,height:0},pt=["minlen","weight","width","height","labeloffset"],mt={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},wt=["labelpos"];function bt(e){var r=new y({multigraph:!0,compound:!0}),n=U(e.graph());return r.setGraph(Z({},gt,X(n,st),G(n,vt))),c(e.nodes(),function(t){var o=U(e.node(t));r.setNode(t,xr(X(o,ht),lt)),r.setParent(t,e.parent(t))}),c(e.edges(),function(t){var o=U(e.edge(t));r.setEdge(t,Z({},mt,X(o,pt),G(o,wt)))}),r}function yt(e){var r=e.graph();r.ranksep/=2,c(e.edges(),function(n){var t=e.edge(n);t.minlen*=2,t.labelpos.toLowerCase()!=="c"&&(r.rankdir==="TB"||r.rankdir==="BT"?t.width+=t.labeloffset:t.height+=t.labeloffset)})}function xt(e){c(e.edges(),function(r){var n=e.edge(r);if(n.width&&n.height){var t=e.node(r.v),o=e.node(r.w),u={rank:(o.rank-t.rank)/2+t.rank,e:r};R(e,"edge-proxy",u,"_ep")}})}function kt(e){var r=0;c(e.nodes(),function(n){var t=e.node(n);t.borderTop&&(t.minRank=e.node(t.borderTop).rank,t.maxRank=e.node(t.borderBottom).rank,r=x(r,t.maxRank))}),e.graph().maxRank=r}function Et(e){c(e.nodes(),function(r){var n=e.node(r);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(r))})}function Nt(e){var r=Number.POSITIVE_INFINITY,n=0,t=Number.POSITIVE_INFINITY,o=0,u=e.graph(),i=u.marginx||0,a=u.marginy||0;function d(f){var s=f.x,g=f.y,v=f.width,h=f.height;r=Math.min(r,s-v/2),n=Math.max(n,s+v/2),t=Math.min(t,g-h/2),o=Math.max(o,g+h/2)}c(e.nodes(),function(f){d(e.node(f))}),c(e.edges(),function(f){var s=e.edge(f);p(s,"x")&&d(s)}),r-=i,t-=a,c(e.nodes(),function(f){var s=e.node(f);s.x-=r,s.y-=t}),c(e.edges(),function(f){var s=e.edge(f);c(s.points,function(g){g.x-=r,g.y-=t}),p(s,"x")&&(s.x-=r),p(s,"y")&&(s.y-=t)}),u.width=n-r+i,u.height=o-t+a}function _t(e){c(e.edges(),function(r){var n=e.edge(r),t=e.node(r.v),o=e.node(r.w),u,i;n.points?(u=n.points[0],i=n.points[n.points.length-1]):(n.points=[],u=o,i=t),n.points.unshift(de(t,u)),n.points.push(de(o,i))})}function It(e){c(e.edges(),function(r){var n=e.edge(r);if(p(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function Rt(e){c(e.edges(),function(r){var n=e.edge(r);n.reversed&&n.points.reverse()})}function Tt(e){c(e.nodes(),function(r){if(e.children(r).length){var n=e.node(r),t=e.node(n.borderTop),o=e.node(n.borderBottom),u=e.node(Y(n.borderLeft)),i=e.node(Y(n.borderRight));n.width=Math.abs(i.x-u.x),n.height=Math.abs(o.y-t.y),n.x=u.x+n.width/2,n.y=t.y+n.height/2}}),c(e.nodes(),function(r){e.node(r).dummy==="border"&&e.removeNode(r)})}function Mt(e){c(e.edges(),function(r){if(r.v===r.w){var n=e.node(r.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:r,label:e.edge(r)}),e.removeEdge(r)}})}function Ct(e){var r=q(e);c(r,function(n){var t=0;c(n,function(o,u){var i=e.node(o);i.order=u+t,c(i.selfEdges,function(a){R(e,"selfedge",{width:a.label.width,height:a.label.height,rank:i.rank,order:u+ ++t,e:a.e,label:a.label},"_se")}),delete i.selfEdges})})}function $t(e){c(e.nodes(),function(r){var n=e.node(r);if(n.dummy==="selfedge"){var t=e.node(n.e.v),o=t.x+t.width/2,u=t.y,i=n.x-o,a=t.height/2;e.setEdge(n.e,n.label),e.removeNode(r),n.label.points=[{x:o+2*i/3,y:u-a},{x:o+5*i/6,y:u-a},{x:o+i,y:u},{x:o+5*i/6,y:u+a},{x:o+2*i/3,y:u+a}],n.label.x=n.x,n.label.y=n.y}})}function X(e,r){return V(G(e,r),Number)}function U(e){var r={};return c(e,function(n,t){r[t.toLowerCase()]=n}),r}export{G,N,Pt as Y,xr as _,re as e,m};
