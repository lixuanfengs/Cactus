import{_ as n,c as a,f as l,o}from"./app-BF9FcIOQ.js";const p={};function e(c,s){return o(),a("div",null,s[0]||(s[0]=[l(`<h2 id="ä¸€ã€dubbo-èƒ½å¹²ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€dubbo-èƒ½å¹²ä»€ä¹ˆ"><span>ä¸€ã€Dubbo èƒ½å¹²ä»€ä¹ˆï¼Ÿ</span></a></h2><p>éšç€äº’è”ç½‘åœºæ™¯çš„æ‰©å±•ï¼Œé¢å¯¹çš„ç”¨æˆ·è§„æ¨¡å’Œä½“é‡ä¸æ–­å¢åŠ ï¼Œç³»ç»Ÿä¹Ÿéœ€è¿›è¡Œç›¸åº”çš„æ‹†åˆ†è®¾è®¡å’Œå®æ–½ã€‚åŸæœ¬å•ä¸€çš„ç³»ç»Ÿç°å·²æ¼”å˜ä¸ºå¤šä¸ªå¾®æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œç”µå•†ç³»ç»Ÿè¿‡å»å¯èƒ½åªéœ€åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å¼€å‘ï¼Œè€Œç°åœ¨åˆ™éœ€è¦å°†ç”¨æˆ·ã€æ”¯ä»˜ã€å•†å“ã€é…é€ã€æ´»åŠ¨å’Œé£æ§ç­‰æ¨¡å—åˆ†ç¦»å‡ºæ¥ã€‚é‚£ä¹ˆï¼Œè¿™äº›æ¨¡å—æ‹†åˆ†åï¼Œåº”å¦‚ä½•å®ç°é«˜æ•ˆçš„é€šä¿¡å‘¢ï¼Ÿ</p><figure><img src="https://lixuanfengs.github.io/blog-images/vp/web/image-20240422161208873.png" alt="image-20240422161208873" tabindex="0" loading="lazy"><figcaption>image-20240422161208873</figcaption></figure><p>å…³äºé€šä¿¡ï¼Œæˆ‘ä»¬å¼•å…¥äº†RPCæ¡†æ¶ï¼Œè€ŒDubboæ˜¯å…¶ä¸­çš„ä¸€ç§å®ç°æ–¹å¼ã€‚é€‰æ‹©Dubboçš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†æé«˜é€šä¿¡æ•ˆç‡ã€‚Dubboé‡‡ç”¨Socketè¿›è¡Œåº•å±‚é€šä¿¡ï¼Œè€Œä¸æ˜¯HTTPï¼Œå› æ­¤å…¶é€šä¿¡æ€§èƒ½æ›´ä¼˜ã€‚åŒæ—¶ï¼ŒDubboå…·å¤‡åˆ†å¸ƒå¼é«˜å¯ç”¨è®¾è®¡ï¼Œå½“éƒ¨ç½²äº†äº¤æ˜“æœåŠ¡çš„æŸç»„å®ä¾‹å‘ç”Ÿæ•…éšœæ—¶ï¼Œè¿™äº›å®ä¾‹ä¼šä»æ³¨å†Œä¸­å¿ƒè¢«æ‘˜é™¤ï¼Œéšåæµé‡å°†è½¬ç§»åˆ°å…¶ä»–æœåŠ¡ä¸Šã€‚è¿™æ ·çš„è®¾è®¡ç¡®ä¿äº†æœåŠ¡çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p><h2 id="äºŒã€è¯¥å¦‚ä½•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#äºŒã€è¯¥å¦‚ä½•ä½¿ç”¨"><span>äºŒã€è¯¥å¦‚ä½•ä½¿ç”¨</span></a></h2><figure><img src="https://lixuanfengs.github.io/blog-images/vp/web/image-20240422161924427.png" alt="image-20240422161924427" tabindex="0" loading="lazy"><figcaption>image-20240422161924427</figcaption></figure><p>Dubboçš„ä½¿ç”¨æ¶‰åŠä¸¤ä¸ªæ–¹é¢ï¼šæ¥å£çš„æä¾›æ–¹å’Œæ¥å£çš„è°ƒç”¨æ–¹ã€‚æ¥å£æä¾›æ–¹éœ€è¦æä¾›æ¥å£çš„æè¿°æ€§ä¿¡æ¯ï¼Œä¾›è°ƒç”¨æ–¹ä½¿ç”¨ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬æ¥å£åç§°ã€æ¥å£çš„è¾“å…¥å‚æ•°å’Œè¾“å‡ºå‚æ•°ã€‚åªæœ‰å½“è°ƒç”¨æ–¹è·å–åˆ°è¿™äº›ä¿¡æ¯åï¼Œæ‰èƒ½åŸºäºè¿™äº›æ¥å£ä¿¡æ¯åˆ›å»ºä¸€ä¸ªä»£ç†ï¼Œé€šè¿‡ä»£ç†ç±»ä½¿ç”¨Socketå®Œæˆä¿¡æ¯çš„äº¤äº’ã€‚</p><p>å› æ­¤ï¼Œè™½ç„¶è¡¨é¢ä¸Šä½¿ç”¨RPCæ¥å£çœ‹ä¼¼ä¸ä½¿ç”¨HTTPæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œåªæ˜¯å¢åŠ äº†POMé…ç½®å’Œæ³¨è§£é…ç½®çš„æ­¥éª¤ï¼Œä½†å®é™…ä¸ŠRPCä½¿ç”¨äº†ä½ çš„Jaræ–‡ä»¶ä½œä¸ºä»£ç†æ“ä½œçš„å¿…è¦å‚æ•°ã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯é€šè¿‡ä»£ç†æ¥å®ç°çš„ã€‚æœ¬æ–‡ä¹Ÿå°†è¿›ä¸€æ­¥ä»‹ç»è¿™ç§ä»£ç†æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><h2 id="ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹"><span>ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹</span></a></h2><p>åŸºæœ¬æ¡ä»¶åŒ…æ‹¬ï¼š</p><ul><li>JDK 1.8</li><li>Maven 3.x - åªè¦æ˜¯æ”¯æŒJDK 1.8çš„ç‰ˆæœ¬å³å¯</li><li>Dubbo 3.1.4 - åœ¨POMæ–‡ä»¶ä¸­å·²ç»é…ç½®å¥½ï¼Œä¸2.xç‰ˆæœ¬ä¸»è¦çš„åŒºåˆ«åœ¨äºä¸€äº›æ³¨è§£çš„ä½¿ç”¨</li><li>Zookeeper 3.4.x - å¦‚æœä½ æ˜¯æŒ‰ç…§æœ¬æ–‡çš„ç›´è¿æ¨¡å¼è¿›è¡Œæµ‹è¯•ï¼Œé‚£ä¹ˆå¯ä»¥ä¸å®‰è£…Zookeeper</li></ul><h3 id="_1-æ¥å£æä¾›æ–¹" tabindex="-1"><a class="header-anchor" href="#_1-æ¥å£æä¾›æ–¹"><span>1. æ¥å£æä¾›æ–¹</span></a></h3><figure><img src="https://lixuanfengs.github.io/blog-images/vp/web/image-20240422170553163.png" alt="image-20240422170553163" tabindex="0" loading="lazy"><figcaption>image-20240422170553163</figcaption></figure><h4 id="_1-1-æ¥å£å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_1-1-æ¥å£å®šä¹‰"><span>1.1 æ¥å£å®šä¹‰</span></a></h4><p><strong>æºç </strong>ï¼š<code>cn.cactusli.dev.tech.dubbo.api.IUserService</code></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> interface</span><span style="color:#E5C07B;"> IUserService</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">    Response</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">UserResDTO</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> queryUserInfo</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">UserReqDTO</span><span style="color:#E06C75;font-style:italic;"> reqDTO</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ¥å£å®šä¹‰çœ‹ä¼¼ç®€å•ï¼Œä½†éšè—äº†ä¸€ä¸ªå…³é”®çš„è¦æ±‚ï¼šæ‰€æœ‰çš„Dubboæ¥å£åŠå…¶å‡ºå…¥å‚ï¼Œé»˜è®¤éƒ½å¿…é¡»å®ç°Serializableæ¥å£ã€‚è¿™æ„å‘³ç€UserReqDTOã€UserResDTOã€Responseè¿™ä¸‰ä¸ªç±»éƒ½éœ€è¦ç»§æ‰¿Serializableåºåˆ—åŒ–æ¥å£ã€‚è¿™ä¸€è®¾è®¡æ˜¯ä¸ºäº†ç¡®ä¿è¿™äº›å¯¹è±¡åœ¨ç½‘ç»œé—´ä¼ è¾“æ—¶èƒ½å¤Ÿè¢«æ­£ç¡®åœ°åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p></blockquote><h4 id="_1-2-æ¥å£å®ç°" tabindex="-1"><a class="header-anchor" href="#_1-2-æ¥å£å®ç°"><span>1.2 æ¥å£å®ç°</span></a></h4><p><strong>æºç </strong>ï¼š<code>cn.cactusli.dev.tech.dubbo.trigger.rpc.UserService</code></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Slf4j</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">DubboService</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">version</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;1.0.0&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> UserService</span><span style="color:#C678DD;"> implements</span><span style="color:#E5C07B;"> IUserService</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#E5C07B;"> Response</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">UserResDTO</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> queryUserInfo</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">UserReqDTO</span><span style="color:#E06C75;font-style:italic;"> reqDTO</span><span style="color:#ABB2BF;">)</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">        log</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ userId: {} reqStr: {}&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">reqDTO</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getUserId</span><span style="color:#ABB2BF;">(), </span><span style="color:#E5C07B;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;">(reqDTO));</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            // 1. æ¨¡æ‹ŸæŸ¥è¯¢ã€ä½ å¯ä»¥ä»æ•°æ®åº“æˆ–è€…Redisç¼“å­˜è·å–æ•°æ®ã€‘</span></span>
<span class="line"><span style="color:#E5C07B;">            UserResDTO</span><span style="color:#E06C75;"> resDTO</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> UserResDTO</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">builder</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">userId</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">reqDTO</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getUserId</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">userName</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ä»™äººçƒ&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">userAge</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">build</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            // 2. è¿”å›ç»“æœ</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> Response.</span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">UserResDTO</span><span style="color:#56B6C2;">&gt;</span><span style="color:#61AFEF;">builder</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">code</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Constants</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ResponseCode</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">SUCCESS</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getCode</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Constants</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ResponseCode</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">SUCCESS</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getInfo</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">data</span><span style="color:#ABB2BF;">(resDTO).</span><span style="color:#61AFEF;">build</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Exception</span><span style="color:#E06C75;font-style:italic;"> e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">            log</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¤±è´¥ userId: {} reqStr: {}&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">reqDTO</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getUserId</span><span style="color:#ABB2BF;">(), </span><span style="color:#E5C07B;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;">(reqDTO), e);</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#ABB2BF;"> Response.</span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;">UserResDTO</span><span style="color:#56B6C2;">&gt;</span><span style="color:#61AFEF;">builder</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">code</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Constants</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ResponseCode</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">UN_ERROR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getCode</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Constants</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ResponseCode</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">UN_ERROR</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getInfo</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">build</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>åœ¨Dubboä¸­ï¼Œå®ç°æ¥å£éœ€è¦ç”±Dubboæœ¬èº«æ¥ç®¡ç†ï¼Œå› æ­¤Dubboæä¾›äº†<code>@DubboService</code>æ³¨è§£æ¥æ ‡è¯†æœåŠ¡ã€‚è¿™ä¸Springçš„<code>@Service</code>æ³¨è§£å®¹æ˜“æ··æ·†ï¼Œå°¤å…¶æ˜¯åœ¨æ—©æœŸçš„Dubboç‰ˆæœ¬2.7.*ä¸­ï¼ŒDubboä¹Ÿä½¿ç”¨äº†<code>@Service</code>æ³¨è§£ï¼Œè¿™å®¹æ˜“å¯¼è‡´å¼€å‘è€…è¯¯ç”¨Springçš„<code>@Service</code>ã€‚è¿™ç§å°é”™è¯¯å¯èƒ½ä¼šè®©ä½ è°ƒè¯•åŠå¤©æ‰å‘ç°é—®é¢˜æ‰€åœ¨ã€‚</p></blockquote><h4 id="_1-3-å·¥ç¨‹é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-3-å·¥ç¨‹é…ç½®"><span>1.3 å·¥ç¨‹é…ç½®</span></a></h4><p><strong>application.yml</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="color:#E06C75;">dubbo</span><span style="color:#C678DD;">:</span></span>
<span class="line"><span style="color:#E06C75;">  application</span><span style="color:#C678DD;">:</span></span>
<span class="line"><span style="color:#E06C75;">    name</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> lxf</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dev</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">tech</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dubbo</span></span>
<span class="line"><span style="color:#E06C75;">    version</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;"> 1.0</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">0</span></span>
<span class="line"><span style="color:#E06C75;">  registry</span><span style="color:#C678DD;">:</span></span>
<span class="line"><span style="color:#E06C75;">    address</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> zookeeper</span><span style="color:#C678DD;">:</span><span style="color:#7F848E;font-style:italic;">//127.0.0.1:2181 # N/A - æ— zookeeperå¯é…ç½® N/A èµ°ç›´è¿æ¨¡å¼æµ‹è¯•</span></span>
<span class="line"><span style="color:#E06C75;">  protocol</span><span style="color:#C678DD;">:</span></span>
<span class="line"><span style="color:#E06C75;">    name</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> dubbo</span></span>
<span class="line"><span style="color:#E06C75;">    port</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;"> 20881</span></span>
<span class="line"><span style="color:#E06C75;">  scan</span><span style="color:#C678DD;">:</span></span>
<span class="line"><span style="color:#E06C75;">    base</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">packages</span><span style="color:#C678DD;">:</span><span style="color:#E5C07B;"> cn</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">cactusli</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">dev</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">tech</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">dubbo</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">api</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨Dubboä¸­ï¼Œ<code>base-packages</code>ç”¨äºæŒ‡å®šæ‰«æDubboæœåŠ¡æ¥å£çš„å…¥å£ä½ç½®ã€‚ä½ åªéœ€è¦é…ç½®å¥½è¿™ä¸ªå…¥å£ï¼ŒDubboæ¡†æ¶ä¼šè‡ªåŠ¨æ‰¾åˆ°å¯¹åº”çš„å®ç°ç±»ã€‚ä½†æ˜¯ï¼Œè¦æ³¨æ„ï¼Œè¿™äº›æœåŠ¡æ¥å£å’Œå®ç°ç±»å¿…é¡»èƒ½è¢«Springæ¡†æ¶æ‰«æåˆ°å¹¶ç®¡ç†ï¼Œè¿™å°±è¦æ±‚ä½ çš„pomæ–‡ä»¶ä¸­å¿…é¡»ç›´æ¥æˆ–é—´æ¥åœ°å¼•å…¥å®šä¹‰äº†DubboæœåŠ¡çš„æ¨¡å—ã€‚</p><p>å…³äºSpringåº”ç”¨å¼€å‘ï¼Œå®ƒè®²ç©¶çš„æ˜¯â€œçº¦å®šå¤§äºé…ç½®â€ã€‚è¿™æ„å‘³ç€ä½ çš„Applicationç±»çš„åŒ…ååº”è¯¥è¶³å¤Ÿå¹¿æ³›ï¼Œä»¥è¦†ç›–åˆ°å…¶ä»–æ‰€æœ‰ç›¸å…³çš„åŒ…åã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å°†Applicationé…ç½®åœ¨äº†<code>cn.cactusli.dev.tech.dubbo.a.b.c.d.*</code>ï¼Œé‚£ä¹ˆå®ƒé»˜è®¤å¯èƒ½å°±æ‰«æä¸åˆ°<code>cn.cactusli.dev.tech.dubbo.api</code>è¿™ä¸ªåŒ…ã€‚è¿™ç§åŒ…æ‰«æçš„é—®é¢˜å¯èƒ½ä¼šå¯¼è‡´ä½ èŠ±è´¹å¤§é‡æ—¶é—´å»è°ƒè¯•ã€‚</p><p>å¦å¤–ï¼Œå…³äºDubboçš„è¿æ¥é…ç½®ï¼Œå¦‚æœä½ è®¾ç½®äº†<code>address</code>ä¸º<code>N/A</code>ï¼Œè¿™è¡¨ç¤ºä¸é€šè¿‡ä»»ä½•æ³¨å†Œä¸­å¿ƒè¿›è¡Œè¿æ¥ï¼Œä»…ç”¨äºæœ¬åœ°ç›´è¿æµ‹è¯•ã€‚è€Œå¦‚æœä½ é…ç½®äº†å¦‚<code>zookeeper://127.0.0.1:2181</code>è¿™æ ·çš„åœ°å€ï¼Œé‚£ä¹ˆä½ éœ€è¦å…ˆå®‰è£…Zookeeperã€‚å³ä½¿é…ç½®äº†ä½¿ç”¨æ³¨å†Œä¸­å¿ƒï¼Œä½ ä¹Ÿå¯ä»¥è¿›è¡Œç›´è¿æµ‹è¯•ï¼Œè¿™å¯¹äºå¼€å‘å’Œæµ‹è¯•é˜¶æ®µéå¸¸æœ‰ç”¨ã€‚</p><h4 id="_1-4-åº”ç”¨æ„å»º" tabindex="-1"><a class="header-anchor" href="#_1-4-åº”ç”¨æ„å»º"><span>1.4 åº”ç”¨æ„å»º</span></a></h4><p>åœ¨Mavenä¸­ï¼Œ<code>install</code>å‘½ä»¤çš„ä½œç”¨æ˜¯å°†é¡¹ç›®çš„æ‰“åŒ…åçš„jaråŒ…å®‰è£…åˆ°æœ¬åœ°Mavenä»“åº“ä¸­ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯è®©åŒä¸€ä¸ªæœ¬åœ°Mavené…ç½®çš„å…¶ä»–é¡¹ç›®èƒ½å¤Ÿå¼•ç”¨è¿™ä¸ªjaråŒ…ã€‚å½“ä½ æ‰§è¡Œ<code>install</code>å‘½ä»¤åï¼Œç”Ÿæˆçš„jaråŒ…å°±ä¼šè¢«ä¿å­˜åœ¨ä½ çš„æœ¬åœ°Mavenä»“åº“é‡Œï¼Œè¿™ä½¿å¾—å…¶ä»–ä¾èµ–äºæ­¤jaråŒ…çš„é¡¹ç›®å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œæ„å»ºå’Œå¼€å‘ã€‚</p><figure><img src="https://lixuanfengs.github.io/blog-images/vp/web/image-20240422172905704.png" alt="image-20240422172905704" tabindex="0" loading="lazy"><figcaption>image-20240422172905704</figcaption></figure><h3 id="_2-æ¥å£ä½¿ç”¨æ–¹" tabindex="-1"><a class="header-anchor" href="#_2-æ¥å£ä½¿ç”¨æ–¹"><span>2. æ¥å£ä½¿ç”¨æ–¹</span></a></h3><h4 id="_2-1-pom-å¼•å…¥" tabindex="-1"><a class="header-anchor" href="#_2-1-pom-å¼•å…¥"><span>2.1 POM å¼•å…¥</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#56B6C2;">&lt;</span><span style="color:#E06C75;">dependency</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#56B6C2;">    &lt;</span><span style="color:#E06C75;">groupId</span><span style="color:#56B6C2;">&gt;</span><span style="color:#E5C07B;">cn</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">cactusli</span><span style="color:#56B6C2;">&lt;/</span><span style="color:#E06C75;">groupId</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#56B6C2;">    &lt;</span><span style="color:#E06C75;">artifactId</span><span style="color:#56B6C2;">&gt;</span><span style="color:#E06C75;">lxf</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dev</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">tech</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dubbo</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">api</span><span style="color:#56B6C2;">&lt;/</span><span style="color:#E06C75;">artifactId</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#56B6C2;">    &lt;</span><span style="color:#E06C75;">version</span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;">1.0</span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">SNAPSHOT</span><span style="color:#56B6C2;">&lt;/</span><span style="color:#E06C75;">version</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#56B6C2;">&lt;/</span><span style="color:#E06C75;">dependency</span><span style="color:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>POM çš„é…ç½®ï¼Œå°±æ˜¯æŠŠ Jar åŒ…ç»™å¼•ç”¨è¿›æ¥ã€‚å› ä¸º Dubbo éœ€è¦æ ¹æ®è¿™ä¸ªæ¥å£ï¼Œåšä¸€ä¸ªä»£ç†æ“ä½œã€‚<strong>ä¸å¼•å…¥ï¼Œä½ ä»£ç å°±çˆ†çº¢å•¦ï¼çˆ†çº¢å•¦ï¼ğŸŒ¶</strong></p></blockquote><h4 id="_2-2-æ¶ˆè´¹é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-2-æ¶ˆè´¹é…ç½®"><span>2.2 æ¶ˆè´¹é…ç½®</span></a></h4><p><strong>æºç </strong>ï¼š<code>application.yml</code></p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" data-title="yml" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E06C75;">dubbo</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">  application</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">    name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">lxf-dev-tech-dubbo</span></span>
<span class="line"><span style="color:#E06C75;">    version</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1.0.0</span></span>
<span class="line"><span style="color:#E06C75;">  registry</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">     address</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">zookeeper://127.0.0.1:2181</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#    address: N/A</span></span>
<span class="line"><span style="color:#E06C75;">  protocol</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">    name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">dubbo</span></span>
<span class="line"><span style="color:#E06C75;">    port</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">20881</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>é…ç½®äº† zookeeper ä½ å°±ç”¨ç¬¬ä¸€ä¸ªï¼Œä»£ç ä¸­å¯¹åº” <code>@DubboReference(interfaceClass = IUserService.class, version = &quot;1.0.0&quot;)</code></p><p>é…ç½®äº† N/A ä½ å°±ç”¨ç¬¬äºŒä¸ªï¼Œä»£ç ä¸­å¿…é¡»æŒ‡å®šç›´è¿ã€‚<code>@DubboReference(interfaceClass = IUserService.class, url = &quot;dubbo://127.0.0.1:20881&quot;, version = &quot;1.0.0&quot;)</code></p></blockquote><h4 id="_2-3-ä»£ç é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-3-ä»£ç é…ç½®"><span>2.3 ä»£ç é…ç½®</span></a></h4><p><strong>æºç </strong>ï¼š<code>cn.cactusli.dev.tech.dubbo.consumer.test.ApiTest</code></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ç›´è¿æ¨¡å¼ï¼›@DubboReference(interfaceClass = IUserService.class, url = &quot;dubbo://127.0.0.1:20881&quot;, version = &quot;1.0.0&quot;)</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">DubboReference</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">interfaceClass</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> IUserService</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;"> version</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;1.0.0&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#C678DD;">private</span><span style="color:#E5C07B;"> IUserService</span><span style="color:#E06C75;"> userService</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Test</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> test_userService</span><span style="color:#E06C75;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">    UserReqDTO</span><span style="color:#E06C75;"> reqDTO </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> UserReqDTO</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">builder</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">userId</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">build</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">    Response</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">UserResDTO</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> resDTO </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> userService</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">queryUserInfo</span><span style="color:#ABB2BF;">(reqDTO);</span></span>
<span class="line"><span style="color:#E5C07B;">    log</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æµ‹è¯•ç»“æœ req: {} res: {}&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;">(reqDTO), </span><span style="color:#E5C07B;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;">(resDTO));</span></span>
<span class="line"><span style="color:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#D19A66;">2024</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">04</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">22</span><span style="color:#D19A66;"> 17</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">58</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">44.523</span><span style="color:#E06C75;">  INFO </span><span style="color:#D19A66;">21596</span><span style="color:#ABB2BF;"> --</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;"> [           main] </span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">d</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">t</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">d</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">RPCProxyBeanFactory</span><span style="color:#C678DD;">   :</span><span style="color:#E5C07B;"> Rpc</span><span style="color:#E06C75;"> Socket é“¾æ¥ç­‰å¾…ï¼Œéœ€è¦å¯åŠ¨ lxf</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dev</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">tech</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dubbo é»˜è®¤æä¾› </span><span style="color:#D19A66;">127.0</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">0</span><span style="color:#ABB2BF;">.</span><span style="color:#FFFFFF;">1</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">22881</span><span style="color:#E06C75;"> é“¾æ¥åœ°å€</span><span style="color:#ABB2BF;">...</span></span>
<span class="line"><span style="color:#D19A66;">2024</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">04</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">22</span><span style="color:#D19A66;"> 17</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">58</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">45.421</span><span style="color:#E06C75;">  INFO </span><span style="color:#D19A66;">21596</span><span style="color:#ABB2BF;"> --</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;"> [           main] </span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">d</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">tech</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">dubbo</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">consumer</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">test</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ApiTest</span><span style="color:#C678DD;">   :</span><span style="color:#E5C07B;"> Started</span><span style="color:#E5C07B;"> ApiTest</span><span style="color:#E06C75;"> in </span><span style="color:#D19A66;">2.512</span><span style="color:#61AFEF;"> seconds</span><span style="color:#E06C75;"> (</span><span style="color:#E5C07B;">JVM</span><span style="color:#E06C75;"> running </span><span style="color:#C678DD;">for</span><span style="color:#D19A66;"> 3.035</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#D19A66;">2024</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">04</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">22</span><span style="color:#D19A66;"> 17</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">58</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">45.778</span><span style="color:#E06C75;">  INFO </span><span style="color:#D19A66;">21596</span><span style="color:#ABB2BF;"> --</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;"> [           main] </span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">d</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">tech</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">dubbo</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">consumer</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">test</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ApiTest</span><span style="color:#C678DD;">   :</span><span style="color:#E06C75;"> æµ‹è¯•ç»“æœ req</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> {</span><span style="color:#98C379;">&quot;userId&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;10001&quot;</span><span style="color:#E06C75;">} res</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> {</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;0000&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;">{</span><span style="color:#98C379;">&quot;userAge&quot;</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;userId&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;userName&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;ä»™äººçƒ&quot;</span><span style="color:#E06C75;">}</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;info&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;æˆåŠŸ&quot;</span><span style="color:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å››ã€åŸç†çš„åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å››ã€åŸç†çš„åˆ†æ"><span>å››ã€åŸç†çš„åˆ†æ</span></a></h2><p>Jar æ–‡ä»¶ä¸ä»…åŒ…å«å¯æ‰§è¡Œçš„ä»£ç ï¼Œè¿˜åŒ…å«äº†æè¿°æ€§çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä½¿å¾—è¿œç¨‹æœåŠ¡èƒ½å¤Ÿè¢«æ­£ç¡®åœ°ä»£ç†å’Œè°ƒç”¨ã€‚åœ¨ Dubbo çš„æ¶æ„ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸»è¦ä¾èµ–äºæ¥å£å®šä¹‰å’ŒæœåŠ¡æ³¨å†Œä¸å‘ç°æœºåˆ¶ã€‚</p><p>é¦–å…ˆï¼ŒæœåŠ¡æä¾›è€…ï¼ˆProviderï¼‰ä¼šå°†è‡ªå·±çš„æ¥å£ã€æ–¹æ³•ä»¥åŠåœ°å€ç­‰ä¿¡æ¯æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼Œå¦‚ Zookeeperã€‚è¿™äº›ä¿¡æ¯è¢«å°è£…åœ¨ Jar æ–‡ä»¶ä¸­ã€‚å½“æœåŠ¡æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰éœ€è¦è°ƒç”¨è¿™äº›æœåŠ¡æ—¶ï¼Œå®ƒä¼šä»æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢è¿™äº›æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„ä½ç½®ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæ¶ˆè´¹è€…ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥å»ºç«‹ä¸æœåŠ¡æä¾›è€…çš„è¿æ¥ï¼Œå¹¶é€šè¿‡ä»£ç†ï¼ˆProxyï¼‰çš„æ–¹å¼è°ƒç”¨è¿œç¨‹æœåŠ¡ã€‚è¿™ä¸ªä»£ç†é€šå¸¸æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œä¸éœ€è¦æ‰‹å†™ï¼ŒDubbo æ¡†æ¶ä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ªæœåŠ¡æ¥å£ç”Ÿæˆä¸€ä¸ªä»£ç†ã€‚è¿™ä¸ªä»£ç†èƒŒåä½¿ç”¨äº† Java çš„åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶åˆ›å»ºå¹¶è°ƒç”¨æœåŠ¡ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒDubbo å®ç°äº†æœåŠ¡çš„é€æ˜è¿œç¨‹è°ƒç”¨ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œæå¤§åœ°ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼€å‘</p><figure><img src="https://lixuanfengs.github.io/blog-images/vp/web/image-20240423100041112.png" alt="image-20240423100041112" tabindex="0" loading="lazy"><figcaption>image-20240423100041112</figcaption></figure><p>å¦‚æœæ‰€ç¤ºï¼Œæ¥å£ä½¿ç”¨æ–¹ï¼Œå¯¹æ¥å£è¿›è¡Œä»£ç†ã€‚ä»€ä¹ˆæ˜¯ä»£ç†å‘¢ï¼Œä»£ç†ï¼ˆProxyï¼‰æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºåœ¨è®¿é—®å¯¹è±¡æ—¶æä¾›ä¸€ä¸ªæ›¿ä»£æˆ–å ä½ç¬¦ã€‚è¿™æ ·ï¼Œä»£ç†å¯ä»¥æ§åˆ¶å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œå¢åŠ é¢å¤–çš„åŠŸèƒ½æˆ–å¤„ç†æ­¥éª¤ã€‚</p><p>åœ¨è¿™é‡Œï¼Œä»£ç†çš„æ¦‚å¿µæŒ‡çš„æ˜¯æ ¹æ®æ¥å£çš„ä¿¡æ¯åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚è¿™ä¸ªä»£ç†å¯¹è±¡å†…éƒ¨å°è£…äº†Socketè¯·æ±‚çš„å¤„ç†ã€‚å½“å¼€å‘è€…è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ï¼Œä»£ç†å¯¹è±¡ä¼šæ ¹æ®æ¥å£å®šä¹‰ï¼Œé€šè¿‡Socketå‘æœåŠ¡æä¾›æ–¹å‘èµ·è¯·æ±‚ã€‚æœåŠ¡æä¾›æ–¹æ¥æ”¶åˆ°è¯·æ±‚åï¼Œè§£æè¯·æ±‚å†…å®¹ï¼Œå¹¶é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨ç›¸åº”çš„æœåŠ¡æ–¹æ³•ã€‚å®Œæˆå¤„ç†åï¼Œç»“æœé€šè¿‡Socketè¿”å›ç»™è°ƒç”¨æ–¹ã€‚</p><p>æ¥å£æä¾›æ–¹ï¼Œä¹Ÿå°±æ˜¯Socketçš„æ¥æ”¶æ–¹ï¼Œåœ¨æ”¶åˆ°ä¿¡æ¯åï¼Œä¼šæ ¹æ®æ¥å£çš„æè¿°æ€§å†…å®¹è¿›è¡Œåå°„è°ƒç”¨ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ç«¯è§£æå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ•°æ®ï¼Œæ ¹æ®è¯·æ±‚ä¸­æŒ‡å®šçš„æ–¹æ³•åå’Œå‚æ•°ï¼Œä½¿ç”¨åå°„æŠ€æœ¯æ‰¾åˆ°å¹¶æ‰§è¡Œç›¸åº”çš„æ–¹æ³•ã€‚æ–¹æ³•æ‰§è¡Œå®Œæ¯•åï¼Œå°†ç»“æœé€šè¿‡Socketå‘é€å›å®¢æˆ·ç«¯ã€‚è¿™æ ·ï¼Œå®¢æˆ·ç«¯å°±èƒ½æ¥æ”¶åˆ°å®ƒè¯·æ±‚çš„æ•°æ®ï¼Œå®Œæˆä¸€æ¬¡å®Œæ•´çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ã€‚</p><h3 id="_1-æ¥å£ä»£ç†-æä¾›æ–¹" tabindex="-1"><a class="header-anchor" href="#_1-æ¥å£ä»£ç†-æä¾›æ–¹"><span>1. æ¥å£ä»£ç† - æä¾›æ–¹</span></a></h3><p><strong>æºç </strong>ï¼š<code>cn.cactusli.dev.tech.dubbo.trigger.socket.RpcServerSocket</code></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Slf4j</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Service</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> RpcServerSocket</span><span style="color:#C678DD;"> implements</span><span style="color:#E5C07B;"> Runnable</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    private</span><span style="color:#E5C07B;"> ApplicationContext</span><span style="color:#E06C75;"> applicationContext</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#61AFEF;"> RpcServerSocket</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ApplicationContext</span><span style="color:#E06C75;font-style:italic;"> applicationContext</span><span style="color:#ABB2BF;">)</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">        this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">applicationContext</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> applicationContext;</span></span>
<span class="line"><span style="color:#C678DD;">        new</span><span style="color:#61AFEF;"> Thread</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> run</span><span style="color:#ABB2BF;">()</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">        NioEventLoopGroup</span><span style="color:#E06C75;"> boosGroup</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> NioEventLoopGroup</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">        NioEventLoopGroup</span><span style="color:#E06C75;"> workerGroup</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> NioEventLoopGroup</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">            ServerBootstrap</span><span style="color:#E06C75;"> b</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> ServerBootstrap</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">            b</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">group</span><span style="color:#ABB2BF;">(boosGroup, workerGroup)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">channel</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">NioServerSocketChannel</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">option</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ChannelOption</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">SO_BACKLOG</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">128</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">childHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#E5C07B;"> ChannelInitializer</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">SocketChannel</span><span style="color:#ABB2BF;">&gt;() {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">                        protected</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> initChannel</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">SocketChannel</span><span style="color:#E06C75;font-style:italic;"> socketChannel</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">                            socketChannel</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pipeline</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">addLast</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#61AFEF;"> ObjectEncoder</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E5C07B;">                            socketChannel</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pipeline</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">addLast</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#61AFEF;"> ObjectDecoder</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Integer</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">MAX_VALUE</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">null</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#E5C07B;">                            socketChannel</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pipeline</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">addLast</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#E5C07B;"> SimpleChannelInboundHandler</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Map</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">&gt;&gt;() {</span></span>
<span class="line"><span style="color:#ABB2BF;">                                @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">                                protected</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> channelRead0</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ChannelHandlerContext</span><span style="color:#E06C75;font-style:italic;"> channelHandlerContext</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Map</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">request</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                                    // è§£æå‚æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">                                    Class</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;">clazz</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Class</span><span style="color:#56B6C2;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;">) </span><span style="color:#E5C07B;">request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;clazz&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">                                    String</span><span style="color:#E06C75;"> methodName</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (String) </span><span style="color:#E5C07B;">request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;methodName&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">                                    Class</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">&gt;[] </span><span style="color:#E06C75;">paramTypes</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Class</span><span style="color:#56B6C2;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;">[]) </span><span style="color:#E5C07B;">request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;paramTypes&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">                                    Object</span><span style="color:#ABB2BF;">[] </span><span style="color:#E06C75;">args</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">[]) </span><span style="color:#E5C07B;">request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;args&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                                    // åå°„è°ƒç”¨</span></span>
<span class="line"><span style="color:#E5C07B;">                                    Method</span><span style="color:#E06C75;"> method</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> clazz</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getMethod</span><span style="color:#ABB2BF;">(methodName, paramTypes);</span></span>
<span class="line"><span style="color:#E5C07B;">                                    Object</span><span style="color:#E06C75;"> invoke</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> method</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">invoke</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">applicationContext</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getBean</span><span style="color:#ABB2BF;">(clazz), args);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                                    // å°è£…ç»“æœ</span></span>
<span class="line"><span style="color:#E5C07B;">                                    Map</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;">response</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;">&lt;&gt;();</span></span>
<span class="line"><span style="color:#E5C07B;">                                    response</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">, invoke);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">                                    log</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;RPC è¯·æ±‚è°ƒç”¨ clazz:{} methodName:{}, response:{}&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">clazz</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getName</span><span style="color:#ABB2BF;">(), methodName, </span><span style="color:#E5C07B;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toJSON</span><span style="color:#ABB2BF;">(response));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                                    // å›å†™æ•°æ®</span></span>
<span class="line"><span style="color:#E5C07B;">                                    channelHandlerContext</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">channel</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">writeAndFlush</span><span style="color:#ABB2BF;">(response);</span></span>
<span class="line"><span style="color:#ABB2BF;">                                }</span></span>
<span class="line"><span style="color:#ABB2BF;">                            });</span></span>
<span class="line"><span style="color:#ABB2BF;">                        }</span></span>
<span class="line"><span style="color:#ABB2BF;">                    });</span></span>
<span class="line"><span style="color:#E5C07B;">            ChannelFuture</span><span style="color:#E06C75;"> f</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> b</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">bind</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">22881</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">sync</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">            f</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">channel</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">closeFuture</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">sync</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Exception</span><span style="color:#E06C75;font-style:italic;"> e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">            log</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;RpcServerSocket run error&quot;</span><span style="color:#ABB2BF;">, e);</span></span>
<span class="line"><span style="color:#E5C07B;">            e</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">printStackTrace</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        } </span><span style="color:#C678DD;">finally</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">            boosGroup</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">shutdownGracefully</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">            workerGroup</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">shutdownGracefully</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ä»£ç ä¸»è¦æä¾›çš„åŠŸèƒ½æ˜¯ï¼š</p><ol><li>Netty Socket å¯åŠ¨ä¸€ä¸ªæœåŠ¡ç«¯</li><li>æ³¨å…¥ ApplicationContext applicationContext ç”¨äºåœ¨æ¥æ”¶åˆ°è¯·æ±‚æ¥å£ä¿¡æ¯åï¼Œè·å–å¯¹åº”çš„ Bean å¯¹è±¡ã€‚</li><li>æ ¹æ®è¯·æ±‚æ¥çš„ Bean å¯¹è±¡ï¼Œä»¥åŠå‚æ•°çš„å¿…è¦ä¿¡æ¯ã€‚è¿›è¡Œæ¥å£çš„åå°„è°ƒç”¨ã€‚</li><li>æœ€åä¸€æ­¥ï¼Œå°±æ˜¯æŠŠæ¥å£åå°„è¯·æ±‚çš„ä¿¡æ¯ï¼Œå†é€šè¿‡ Socket è¿”å›å›å»ã€‚</li></ol><h3 id="_2-æ¥å£åå°„-è°ƒç”¨æ–¹" tabindex="-1"><a class="header-anchor" href="#_2-æ¥å£åå°„-è°ƒç”¨æ–¹"><span>2. æ¥å£åå°„ - è°ƒç”¨æ–¹</span></a></h3><p><strong>æºç </strong>ï¼š<code>cn.cactusli.dev.tech.dubbo.consumer.config.RPCProxyBeanFactory</code></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Slf4j</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Component</span><span style="color:#E06C75;">(</span><span style="color:#98C379;">&quot;rpcProxyBeanFactory&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> class</span><span style="color:#E5C07B;"> RPCProxyBeanFactory</span><span style="color:#C678DD;"> implements</span><span style="color:#E5C07B;"> FactoryBean</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">IUserService</span><span style="color:#ABB2BF;">&gt;,</span><span style="color:#E5C07B;"> Runnable</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    private</span><span style="color:#E5C07B;"> Channel</span><span style="color:#E06C75;"> channel</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // ç¼“å­˜æ•°æ®ï¼Œå®é™…RPCä¼šå¯¹æ¯æ¬¡çš„è°ƒç”¨ç”Ÿæˆä¸€ä¸ªIDæ¥æ ‡è®°è·å–</span></span>
<span class="line"><span style="color:#C678DD;">    private</span><span style="color:#E5C07B;"> Object</span><span style="color:#E06C75;"> responseCache</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#E5C07B;"> IUserService</span><span style="color:#61AFEF;"> getObject</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">        ClassLoader</span><span style="color:#E06C75;"> classLoader</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Thread</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">currentThread</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">getContextClassLoader</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">        Class</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">&gt;[] </span><span style="color:#E06C75;">classes</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span><span style="color:#E5C07B;">IUserService</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#E5C07B;">        InvocationHandler</span><span style="color:#E06C75;"> handler</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> InvocationHandler</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">            @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">            public</span><span style="color:#E5C07B;"> Object</span><span style="color:#61AFEF;"> invoke</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Object</span><span style="color:#E06C75;font-style:italic;"> proxy</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Method</span><span style="color:#E06C75;font-style:italic;"> method</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">[] </span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Throwable</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">                if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">equals</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">method</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getDeclaringClass</span><span style="color:#ABB2BF;">())) {</span></span>
<span class="line"><span style="color:#C678DD;">                    return</span><span style="color:#E5C07B;"> method</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">invoke</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">, args);</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#E5C07B;">                Map</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;">request</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> HashMap</span><span style="color:#ABB2BF;">&lt;&gt;();</span></span>
<span class="line"><span style="color:#E5C07B;">                request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;clazz&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">IUserService</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">                request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;methodName&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">method</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getName</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E5C07B;">                request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;paramTypes&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">method</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getParameterTypes</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E5C07B;">                request</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;args&quot;</span><span style="color:#ABB2BF;">, args);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">                channel</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeAndFlush</span><span style="color:#ABB2BF;">(request);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                // æ¨¡æ‹Ÿè¶…æ—¶ç­‰å¾…ï¼Œä¸€èˆ¬RPCæ¥å£è¯·æ±‚ï¼Œéƒ½æœ‰ä¸€ä¸ªè¶…æ—¶ç­‰å¾…æ—¶é•¿ã€‚</span></span>
<span class="line"><span style="color:#E5C07B;">                Thread</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">350</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">                return</span><span style="color:#ABB2BF;"> responseCache;</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        };</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#ABB2BF;"> (IUserService) </span><span style="color:#E5C07B;">Proxy</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">newProxyInstance</span><span style="color:#ABB2BF;">(classLoader, classes, handler);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#E5C07B;"> Class</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> getObjectType</span><span style="color:#ABB2BF;">()</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> IUserService</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#61AFEF;"> RPCProxyBeanFactory</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> InterruptedException</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">        new</span><span style="color:#61AFEF;"> Thread</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">        while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">null</span><span style="color:#56B6C2;"> ==</span><span style="color:#ABB2BF;"> channel) {</span></span>
<span class="line"><span style="color:#E5C07B;">            Thread</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">550</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">            log</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Rpc Socket é“¾æ¥ç­‰å¾…ï¼Œéœ€è¦å¯åŠ¨ lxf-dev-tech-dubbo é»˜è®¤æä¾› 127.0.0.1:22881 é“¾æ¥åœ°å€...&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">    public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> run</span><span style="color:#ABB2BF;">()</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">        NioEventLoopGroup</span><span style="color:#E06C75;"> workerGroup</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> NioEventLoopGroup</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">        try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">            Bootstrap</span><span style="color:#E06C75;"> b</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Bootstrap</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">            b</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">group</span><span style="color:#ABB2BF;">(workerGroup)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">channel</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">NioSocketChannel</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">option</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ChannelOption</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">AUTO_READ</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                    .</span><span style="color:#61AFEF;">handler</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#E5C07B;"> ChannelInitializer</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">SocketChannel</span><span style="color:#ABB2BF;">&gt;() {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">                        protected</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> initChannel</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">SocketChannel</span><span style="color:#E06C75;font-style:italic;"> channel</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">                            channel</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pipeline</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">addLast</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#61AFEF;"> ObjectEncoder</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E5C07B;">                            channel</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pipeline</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">addLast</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#61AFEF;"> ObjectDecoder</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ClassResolvers</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">cacheDisabled</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">null</span><span style="color:#ABB2BF;">)));</span></span>
<span class="line"><span style="color:#E5C07B;">                            channel</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pipeline</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">addLast</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#E5C07B;"> SimpleChannelInboundHandler</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Map</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">&gt;&gt;() {</span></span>
<span class="line"><span style="color:#ABB2BF;">                                @</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">                                protected</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> channelRead0</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ChannelHandlerContext</span><span style="color:#E06C75;font-style:italic;"> channelHandlerContext</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Map</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;"> throws</span><span style="color:#E5C07B;"> Exception</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    responseCache </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> data</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                                }</span></span>
<span class="line"><span style="color:#ABB2BF;">                            });</span></span>
<span class="line"><span style="color:#ABB2BF;">                        }</span></span>
<span class="line"><span style="color:#ABB2BF;">                    });</span></span>
<span class="line"><span style="color:#E5C07B;">            ChannelFuture</span><span style="color:#E06C75;"> channelFuture</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> b</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">connect</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;127.0.0.1&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">22881</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">syncUninterruptibly</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">            this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">channel</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> channelFuture</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">channel</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">            channelFuture</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">channel</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">closeFuture</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">syncUninterruptibly</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        } </span><span style="color:#C678DD;">finally</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">            workerGroup</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">shutdownGracefully</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ä»£ç ä¸»è¦æä¾›çš„åŠŸèƒ½æ˜¯ï¼š</p><ol><li>å®ç° <code>FactoryBean&lt;IUserService&gt;</code> ä¸ºçš„æ˜¯æŠŠè¿™æ ·ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œäº¤ç»™ Spring å®¹å™¨ç®¡ç†ã€‚</li><li>å®ç° Runnable æ¥å£ï¼Œå¹¶åœ¨æ¥å£ä¸­ï¼Œåˆ›å»º Netty çš„ Socket å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä¸­æ¥æ”¶æ¥è‡ªæœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼Œå¹¶ä¸´æ—¶å­˜æ”¾åˆ°ç¼“å­˜ä¸­ã€‚<strong>æ³¨æ„ Dubbo ä¸­è¿™å—çš„å¤„ç†ä¼šå¤æ‚ä¸€äº›ï¼Œä»¥åŠè¯·æ±‚åŒæ­¥å“åº”é€šä¿¡ï¼Œè¿™æ ·æ‰èƒ½æŠŠå„ä¸ªæ¥å£çš„è°ƒåŠ¨è®°å½•ä¸‹æ¥</strong></li><li><code>getObject()</code> å¯¹è±¡ä¸­ï¼Œæä¾›ä»£ç†æ“ä½œã€‚ä»£ç†é‡Œï¼Œå°±å¯ä»¥è‡ªå·±æƒ³å’‹æå’‹æäº†ã€‚è€Œ Dubbo ä¹Ÿæ˜¯åœ¨ä»£ç†é‡Œï¼Œæä¾›äº†å¦‚æ­¤çš„æ“ä½œï¼Œå¯¹æ¥å£æä¾›æ–¹å‘é€è¯·æ±‚æ¶ˆæ¯ï¼Œå¹¶åœ¨è¶…æ—¶æ—¶é—´å†…è¿”å›æ¥å£ä¿¡æ¯ã€‚å› ä¸ºåå°„è°ƒç”¨ï¼Œéœ€è¦ä½ <code>æä¾›ç±»</code>ã€<code>æ–¹æ³•</code>ã€<code>å…¥å‚ç±»å‹</code>ã€<code>å…¥å‚å†…å®¹</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠè¿™äº›ä¿¡æ¯ä¼ é€’ç»™æ¥å£æä¾›æ–¹ã€‚</li></ol><h3 id="_3-æœåŠ¡æµ‹è¯•-æ¶ˆè´¹éªŒè¯" tabindex="-1"><a class="header-anchor" href="#_3-æœåŠ¡æµ‹è¯•-æ¶ˆè´¹éªŒè¯"><span>3. æœåŠ¡æµ‹è¯• - æ¶ˆè´¹éªŒè¯</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Resource</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;rpcProxyBeanFactory&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#C678DD;">private</span><span style="color:#E5C07B;"> IUserService</span><span style="color:#E06C75;"> proxyUserService</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Test</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#C678DD;"> void</span><span style="color:#61AFEF;"> test_proxyUserService</span><span style="color:#E06C75;">(){</span></span>
<span class="line"><span style="color:#E5C07B;">    UserReqDTO</span><span style="color:#E06C75;"> reqDTO </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> UserReqDTO</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">builder</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">userId</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">build</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">    Response</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">UserResDTO</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> resDTO </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> proxyUserService</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">queryUserInfo</span><span style="color:#ABB2BF;">(reqDTO);</span></span>
<span class="line"><span style="color:#E5C07B;">    log</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æµ‹è¯•ç»“æœ req: {} res: {}&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;">(reqDTO), </span><span style="color:#E5C07B;">JSON</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toJSONString</span><span style="color:#ABB2BF;">(resDTO));</span></span>
<span class="line"><span style="color:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æµ‹è¯•ç»“æœ</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#282c34;color:#abb2bf;"><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#D19A66;">2024</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">04</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">23</span><span style="color:#D19A66;"> 11</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">23</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">31.478</span><span style="color:#E06C75;">  INFO </span><span style="color:#D19A66;">18908</span><span style="color:#ABB2BF;"> --</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;"> [           main] </span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">c</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">d</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">tech</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">dubbo</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">consumer</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">test</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ApiTest</span><span style="color:#C678DD;">   :</span><span style="color:#E06C75;"> æµ‹è¯•ç»“æœ req</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> {</span><span style="color:#98C379;">&quot;userId&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;10001&quot;</span><span style="color:#E06C75;">} res</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> {</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;0000&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#C678DD;">:</span><span style="color:#E06C75;">{</span><span style="color:#98C379;">&quot;userAge&quot;</span><span style="color:#C678DD;">:</span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;userId&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;10001&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;userName&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;ä»™äººçƒ&quot;</span><span style="color:#E06C75;">}</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;info&quot;</span><span style="color:#C678DD;">:</span><span style="color:#98C379;">&quot;æˆåŠŸ&quot;</span><span style="color:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>ä»¥ä¸Šä»£ç é‡Œæˆ‘ä»¬ç»™ IUserService æ³¨å…¥ä¸€ä¸ªè‡ªå·±ä»£ç†å¥½çš„å¯¹è±¡ï¼Œä¹‹åå°±å¯ä»¥è°ƒç”¨éªŒè¯äº†ã€‚</p></blockquote>`,67)]))}const r=n(p,[["render",e],["__file","DDD å·¥ç¨‹ Dubbo ä½¿ç”¨æ•™ç¨‹åŠåŸç†åˆ†æ.html.vue"]]),B=JSON.parse(`{"path":"/tutorial/DDD%20%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB/DDD%20%E5%B7%A5%E7%A8%8B%20Dubbo%20%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E5%8F%8A%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90.html","title":"DDD å·¥ç¨‹ Dubbo ä½¿ç”¨æ•™ç¨‹åŠåŸç†åˆ†æ","lang":"zh-CN","frontmatter":{"title":"DDD å·¥ç¨‹ Dubbo ä½¿ç”¨æ•™ç¨‹åŠåŸç†åˆ†æ","subtitle":"DDD å·¥ç¨‹ Dubbo ä½¿ç”¨æ•™ç¨‹åŠåŸç†åˆ†æ","date":"2024-04-11T10:54:20.000Z","category":["DDD æŠ€æœ¯ä½“ç³»"],"tag":["DDD æŠ€æœ¯ä½“ç³»"],"order":6,"description":"ä¸€ã€Dubbo èƒ½å¹²ä»€ä¹ˆï¼Ÿ éšç€äº’è”ç½‘åœºæ™¯çš„æ‰©å±•ï¼Œé¢å¯¹çš„ç”¨æˆ·è§„æ¨¡å’Œä½“é‡ä¸æ–­å¢åŠ ï¼Œç³»ç»Ÿä¹Ÿéœ€è¿›è¡Œç›¸åº”çš„æ‹†åˆ†è®¾è®¡å’Œå®æ–½ã€‚åŸæœ¬å•ä¸€çš„ç³»ç»Ÿç°å·²æ¼”å˜ä¸ºå¤šä¸ªå¾®æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œç”µå•†ç³»ç»Ÿè¿‡å»å¯èƒ½åªéœ€åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å¼€å‘ï¼Œè€Œç°åœ¨åˆ™éœ€è¦å°†ç”¨æˆ·ã€æ”¯ä»˜ã€å•†å“ã€é…é€ã€æ´»åŠ¨å’Œé£æ§ç­‰æ¨¡å—åˆ†ç¦»å‡ºæ¥ã€‚é‚£ä¹ˆï¼Œè¿™äº›æ¨¡å—æ‹†åˆ†åï¼Œåº”å¦‚ä½•å®ç°é«˜æ•ˆçš„é€šä¿¡å‘¢ï¼Ÿ image-20240422161208873i...","head":[["meta",{"property":"og:url","content":"https://cactusli.net/tutorial/DDD%20%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB/DDD%20%E5%B7%A5%E7%A8%8B%20Dubbo%20%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E5%8F%8A%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90.html"}],["meta",{"property":"og:site_name","content":"Cactus's Blog"}],["meta",{"property":"og:title","content":"DDD å·¥ç¨‹ Dubbo ä½¿ç”¨æ•™ç¨‹åŠåŸç†åˆ†æ"}],["meta",{"property":"og:description","content":"ä¸€ã€Dubbo èƒ½å¹²ä»€ä¹ˆï¼Ÿ éšç€äº’è”ç½‘åœºæ™¯çš„æ‰©å±•ï¼Œé¢å¯¹çš„ç”¨æˆ·è§„æ¨¡å’Œä½“é‡ä¸æ–­å¢åŠ ï¼Œç³»ç»Ÿä¹Ÿéœ€è¿›è¡Œç›¸åº”çš„æ‹†åˆ†è®¾è®¡å’Œå®æ–½ã€‚åŸæœ¬å•ä¸€çš„ç³»ç»Ÿç°å·²æ¼”å˜ä¸ºå¤šä¸ªå¾®æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œç”µå•†ç³»ç»Ÿè¿‡å»å¯èƒ½åªéœ€åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å¼€å‘ï¼Œè€Œç°åœ¨åˆ™éœ€è¦å°†ç”¨æˆ·ã€æ”¯ä»˜ã€å•†å“ã€é…é€ã€æ´»åŠ¨å’Œé£æ§ç­‰æ¨¡å—åˆ†ç¦»å‡ºæ¥ã€‚é‚£ä¹ˆï¼Œè¿™äº›æ¨¡å—æ‹†åˆ†åï¼Œåº”å¦‚ä½•å®ç°é«˜æ•ˆçš„é€šä¿¡å‘¢ï¼Ÿ image-20240422161208873i..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://lixuanfengs.github.io/blog-images/vp/web/image-20240422161208873.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-30T09:48:33.000Z"}],["meta",{"property":"article:tag","content":"DDD æŠ€æœ¯ä½“ç³»"}],["meta",{"property":"article:published_time","content":"2024-04-11T10:54:20.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-30T09:48:33.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"DDD å·¥ç¨‹ Dubbo ä½¿ç”¨æ•™ç¨‹åŠåŸç†åˆ†æ\\",\\"image\\":[\\"https://lixuanfengs.github.io/blog-images/vp/web/image-20240422161208873.png\\",\\"https://lixuanfengs.github.io/blog-images/vp/web/image-20240422161924427.png\\",\\"https://lixuanfengs.github.io/blog-images/vp/web/image-20240422170553163.png\\",\\"https://lixuanfengs.github.io/blog-images/vp/web/image-20240422172905704.png\\",\\"https://lixuanfengs.github.io/blog-images/vp/web/image-20240423100041112.png\\"],\\"datePublished\\":\\"2024-04-11T10:54:20.000Z\\",\\"dateModified\\":\\"2024-05-30T09:48:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Cactus li\\",\\"url\\":\\"https://cactusli.net\\"}]}"]]},"headers":[{"level":2,"title":"ä¸€ã€Dubbo èƒ½å¹²ä»€ä¹ˆï¼Ÿ","slug":"ä¸€ã€dubbo-èƒ½å¹²ä»€ä¹ˆ","link":"#ä¸€ã€dubbo-èƒ½å¹²ä»€ä¹ˆ","children":[]},{"level":2,"title":"äºŒã€è¯¥å¦‚ä½•ä½¿ç”¨","slug":"äºŒã€è¯¥å¦‚ä½•ä½¿ç”¨","link":"#äºŒã€è¯¥å¦‚ä½•ä½¿ç”¨","children":[]},{"level":2,"title":"ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹","slug":"ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹","link":"#ä¸‰ã€ä½¿ç”¨çš„æ¡ˆä¾‹","children":[{"level":3,"title":"1. æ¥å£æä¾›æ–¹","slug":"_1-æ¥å£æä¾›æ–¹","link":"#_1-æ¥å£æä¾›æ–¹","children":[]},{"level":3,"title":"2. æ¥å£ä½¿ç”¨æ–¹","slug":"_2-æ¥å£ä½¿ç”¨æ–¹","link":"#_2-æ¥å£ä½¿ç”¨æ–¹","children":[]}]},{"level":2,"title":"å››ã€åŸç†çš„åˆ†æ","slug":"å››ã€åŸç†çš„åˆ†æ","link":"#å››ã€åŸç†çš„åˆ†æ","children":[{"level":3,"title":"1. æ¥å£ä»£ç† - æä¾›æ–¹","slug":"_1-æ¥å£ä»£ç†-æä¾›æ–¹","link":"#_1-æ¥å£ä»£ç†-æä¾›æ–¹","children":[]},{"level":3,"title":"2. æ¥å£åå°„ - è°ƒç”¨æ–¹","slug":"_2-æ¥å£åå°„-è°ƒç”¨æ–¹","link":"#_2-æ¥å£åå°„-è°ƒç”¨æ–¹","children":[]},{"level":3,"title":"3. æœåŠ¡æµ‹è¯• - æ¶ˆè´¹éªŒè¯","slug":"_3-æœåŠ¡æµ‹è¯•-æ¶ˆè´¹éªŒè¯","link":"#_3-æœåŠ¡æµ‹è¯•-æ¶ˆè´¹éªŒè¯","children":[]}]}],"git":{"createdTime":1717062513000,"updatedTime":1717062513000,"contributors":[{"name":"lixuanfengs","email":"1183895890@qq.com","commits":1}]},"readingTime":{"minutes":11,"words":3300},"filePathRelative":"tutorial/DDD æŠ€æœ¯ä½“ç³»/DDD å·¥ç¨‹ Dubbo ä½¿ç”¨æ•™ç¨‹åŠåŸç†åˆ†æ.md","localizedDate":"2024å¹´4æœˆ11æ—¥","excerpt":"<h2>ä¸€ã€Dubbo èƒ½å¹²ä»€ä¹ˆï¼Ÿ</h2>\\n<p>éšç€äº’è”ç½‘åœºæ™¯çš„æ‰©å±•ï¼Œé¢å¯¹çš„ç”¨æˆ·è§„æ¨¡å’Œä½“é‡ä¸æ–­å¢åŠ ï¼Œç³»ç»Ÿä¹Ÿéœ€è¿›è¡Œç›¸åº”çš„æ‹†åˆ†è®¾è®¡å’Œå®æ–½ã€‚åŸæœ¬å•ä¸€çš„ç³»ç»Ÿç°å·²æ¼”å˜ä¸ºå¤šä¸ªå¾®æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œç”µå•†ç³»ç»Ÿè¿‡å»å¯èƒ½åªéœ€åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å¼€å‘ï¼Œè€Œç°åœ¨åˆ™éœ€è¦å°†ç”¨æˆ·ã€æ”¯ä»˜ã€å•†å“ã€é…é€ã€æ´»åŠ¨å’Œé£æ§ç­‰æ¨¡å—åˆ†ç¦»å‡ºæ¥ã€‚é‚£ä¹ˆï¼Œè¿™äº›æ¨¡å—æ‹†åˆ†åï¼Œåº”å¦‚ä½•å®ç°é«˜æ•ˆçš„é€šä¿¡å‘¢ï¼Ÿ</p>\\n<figure><img src=\\"https://lixuanfengs.github.io/blog-images/vp/web/image-20240422161208873.png\\" alt=\\"image-20240422161208873\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption>image-20240422161208873</figcaption></figure>","autoDesc":true}`);export{r as comp,B as data};
