import{z,K as D,Y as R}from"./styles-f32eefb3-DJv2vNQf.js";import{L as c,J as r,T,n as $,F as B,M as N,v as M,z as A,b as C}from"./mermaid.esm.min-Ds9q7Vr_.js";import{Z as j}from"./graph-e9862b7e-DsLgKov8.js";import{b as F}from"./index-5e3196ce-DJU6MHy1.js";import"./app-Da1Br5pT.js";import"./layout-2e6f21ea-8P9ZiItt.js";import"./clone-06085faa-Z2Fw6AUN.js";import"./edges-16a2be2d-CCV5Dlrp.js";import"./createText-323577ec-BA4n_oFW.js";import"./line-552be4bc-BPXCTRjz.js";import"./array-2ff2c7a6-C3YJfAyO.js";import"./path-428ebac9-B0oSrkCJ.js";const S=a=>C.sanitizeText(a,r());let k={dividerMargin:10,padding:5,textHeight:10,curve:void 0};const J=function(a,t,f,s){const e=Object.keys(a);c.info("keys:",e),c.info(a),e.forEach(function(o){var l,d;const n=a[o],i={shape:"rect",id:n.id,domId:n.domId,labelText:S(n.id),labelStyle:"",style:"fill: none; stroke: black",padding:((l=r().flowchart)==null?void 0:l.padding)??((d=r().class)==null?void 0:d.padding)};t.setNode(n.id,i),I(n.classes,t,f,s,n.id),c.info("setNode",i)})},I=function(a,t,f,s,e){const o=Object.keys(a);c.info("keys:",o),c.info(a),o.filter(l=>a[l].parent==e).forEach(function(l){var d,n;const i=a[l],y=i.cssClasses.join(" "),p=N(i.styles),h=i.label??i.id,u=0,g="class_box",b={labelStyle:p.labelStyle,shape:g,labelText:S(h),classData:i,rx:u,ry:u,class:y,style:p.style,id:i.id,domId:i.domId,tooltip:s.db.getTooltip(i.id,e)||"",haveCallback:i.haveCallback,link:i.link,width:i.type==="group"?500:void 0,type:i.type,padding:((d=r().flowchart)==null?void 0:d.padding)??((n=r().class)==null?void 0:n.padding)};t.setNode(i.id,b),e&&t.setParent(i.id,e),c.info("setNode",b)})},P=function(a,t,f,s){c.info(a),a.forEach(function(e,o){var l,d;const n=e,i="",y={labelStyle:"",style:""},p=n.text,h=0,u="note",g={labelStyle:y.labelStyle,shape:u,labelText:S(p),noteData:n,rx:h,ry:h,class:i,style:y.style,id:n.id,domId:n.id,tooltip:"",type:"note",padding:((l=r().flowchart)==null?void 0:l.padding)??((d=r().class)==null?void 0:d.padding)};if(t.setNode(n.id,g),c.info("setNode",g),!n.class||!(n.class in s))return;const b=f+o,w={id:`edgeNote${b}`,classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:M(k.curve,A)};t.setEdge(n.id,n.class,w,b)})},H=function(a,t){const f=r().flowchart;let s=0;a.forEach(function(e){var o;s++;const l={classes:"relation",pattern:e.relation.lineType==1?"dashed":"solid",id:`id_${e.id1}_${e.id2}_${s}`,arrowhead:e.type==="arrow_open"?"none":"normal",startLabelRight:e.relationTitle1==="none"?"":e.relationTitle1,endLabelLeft:e.relationTitle2==="none"?"":e.relationTitle2,arrowTypeStart:E(e.relation.type1),arrowTypeEnd:E(e.relation.type2),style:"fill:none",labelStyle:"",curve:M(f==null?void 0:f.curve,A)};if(c.info(l,e),e.style!==void 0){const d=N(e.style);l.style=d.style,l.labelStyle=d.labelStyle}e.text=e.title,e.text===void 0?e.style!==void 0&&(l.arrowheadStyle="fill: #333"):(l.arrowheadStyle="fill: #333",l.labelpos="c",((o=r().flowchart)==null?void 0:o.htmlLabels)??r().htmlLabels?(l.labelType="html",l.label='<span class="edgeLabel">'+e.text+"</span>"):(l.labelType="text",l.label=e.text.replace(C.lineBreakRegex,`
`),e.style===void 0&&(l.style=l.style||"stroke: #333; stroke-width: 1.5px;fill:none"),l.labelStyle=l.labelStyle.replace("color:","fill:"))),t.setEdge(e.id1,e.id2,l,s)})},K=function(a){k={...k,...a}},O=async function(a,t,f,s){c.info("Drawing class - ",t);const e=r().flowchart??r().class,o=r().securityLevel;c.info("config:",e);const l=(e==null?void 0:e.nodeSpacing)??50,d=(e==null?void 0:e.rankSpacing)??50,n=new j({multigraph:!0,compound:!0}).setGraph({rankdir:s.db.getDirection(),nodesep:l,ranksep:d,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),i=s.db.getNamespaces(),y=s.db.getClasses(),p=s.db.getRelations(),h=s.db.getNotes();c.info(p),J(i,n,t,s),I(y,n,t,s),H(p,n),P(h,n,p.length+1,y);let u;o==="sandbox"&&(u=T("#i"+t));const g=o==="sandbox"?T(u.nodes()[0].contentDocument.body):T("body"),b=g.select(`[id="${t}"]`),w=g.select("#"+t+" g");if(await F(w,n,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",t),$.insertTitle(b,"classTitleText",(e==null?void 0:e.titleTopMargin)??5,s.db.getDiagramTitle()),B(n,b,e==null?void 0:e.diagramPadding,e==null?void 0:e.useMaxWidth),!(e!=null&&e.htmlLabels)){const v=o==="sandbox"?u.nodes()[0].contentDocument:document,_=v.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const x of _){const L=x.getBBox(),m=v.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("rx",0),m.setAttribute("ry",0),m.setAttribute("width",L.width),m.setAttribute("height",L.height),x.insertBefore(m,x.firstChild)}}};function E(a){let t;switch(a){case 0:t="aggregation";break;case 1:t="extension";break;case 2:t="composition";break;case 3:t="dependency";break;case 4:t="lollipop";break;default:t="none"}return t}const W={setConf:K,draw:O},ae={parser:z,db:D,renderer:W,styles:R,init:a=>{a.class||(a.class={}),a.class.arrowMarkerAbsolute=a.arrowMarkerAbsolute,D.clear()}};export{ae as diagram};
